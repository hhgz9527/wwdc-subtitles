1
00:00:17,533 --> 00:00:22,367 line:0
<c.magenta>大家好 我是Eryk Vershen</c>
<c.magenta>在Apple做AVFoundation工程师</c>


2
00:00:22,967 --> 00:00:24,567 line:0
<c.magenta>这里是演讲515</c>


3
00:00:24,633 --> 00:00:28,000 line:0
<c.magenta>内容是关于HLS编写和HLS工具</c>


4
00:00:29,000 --> 00:00:32,467 line:-1
<c.magenta>缩写HLS代表HTTP流媒体传输</c>


5
00:00:33,333 --> 00:00:37,167 line:-2
<c.magenta>HLS可以将内容分流到</c>
<c.magenta>不同的Apple设备</c>


6
00:00:37,867 --> 00:00:39,500 line:-1
<c.magenta>我会讲到这个文件</c>


7
00:00:39,567 --> 00:00:42,767 line:-1
<c.magenta>Apple设备的HLS编写规范</c>


8
00:00:43,000 --> 00:00:46,667 line:-2
<c.magenta>还有我们用来创建</c>
<c.magenta>和验证HLS内容的工具</c>


9
00:00:48,667 --> 00:00:52,533 line:-2
<c.magenta>编写规范以及</c>
<c.magenta>其他重要的HLS文档</c>


10
00:00:52,600 --> 00:00:56,867 line:-2
<c.magenta>可以参阅</c>
<c.magenta>developer.apple.com/streaming</c>


11
00:00:57,500 --> 00:00:59,000 line:-1
<c.magenta>编写规范</c>


12
00:00:59,067 --> 00:01:01,867 line:-1
<c.magenta>是Apple提供的HLS编写建议</c>


13
00:01:03,033 --> 00:01:05,700 line:-1
<c.magenta>我们希望HLS规范互联网草案</c>


14
00:01:05,767 --> 00:01:08,733 line:-1
<c.magenta>只涵盖最必要的要求</c>


15
00:01:09,200 --> 00:01:11,367 line:-2
<c.magenta>编写规范</c>
<c.magenta>从另一方面来说</c>


16
00:01:11,433 --> 00:01:14,200 line:-2
<c.magenta>是针对Apple设备</c>
<c.magenta>所提的要求</c>


17
00:01:14,400 --> 00:01:17,200 line:-1
<c.magenta>以及一些看似不必要的要求</c>


18
00:01:17,400 --> 00:01:18,933 line:-1
<c.magenta>却能形成最佳实践</c>


19
00:01:20,900 --> 00:01:25,000 line:-2
<c.magenta>今年的大新闻</c>
<c.magenta>就是我们添加了HEVC支持</c>


20
00:01:26,100 --> 00:01:28,100 line:-1
<c.magenta>这些就是播放限制</c>


21
00:01:28,367 --> 00:01:32,400 line:-2
<c.magenta>档次为Main 10</c>
<c.magenta>水平为5.0 高等级</c>


22
00:01:33,867 --> 00:01:36,233 line:0
<c.magenta>既然已经支持HEVC内容</c>


23
00:01:36,300 --> 00:01:38,667 line:0
<c.magenta>我们就把码率也写进了规范</c>


24
00:01:39,467 --> 00:01:42,233 line:0
<c.magenta>它们只是初步的建议</c>


25
00:01:42,600 --> 00:01:45,000 line:0
<c.magenta>因为HEVC编码器还在不断进化</c>


26
00:01:45,433 --> 00:01:47,367 line:0
<c.magenta>会随着时间不断改善</c>


27
00:01:47,433 --> 00:01:49,733 line:0
<c.magenta>以后我们也会修改这些指南</c>


28
00:01:51,000 --> 00:01:53,300 line:0
<c.magenta>所以要记住这些码率的建议</c>


29
00:01:53,367 --> 00:01:55,333 line:0
<c.magenta>只是编写规范里的指南</c>


30
00:01:55,400 --> 00:01:56,833 line:-1
<c.magenta>不是隽永的真理</c>


31
00:01:57,500 --> 00:01:59,633 line:0
<c.magenta>我们也知道内容千变万化</c>


32
00:01:59,833 --> 00:02:02,600 line:0
<c.magenta>访谈视频的码率</c>


33
00:02:02,767 --> 00:02:04,767 line:0
<c.magenta>不一定适用于体育节目</c>


34
00:02:05,233 --> 00:02:06,800 line:-1
<c.magenta>而且你会改变限制</c>


35
00:02:06,867 --> 00:02:08,900 line:0
<c.magenta>码率类型的数量</c>


36
00:02:09,199 --> 00:02:11,633 line:0
<c.magenta>所以码率指南只适用于起步阶段</c>


37
00:02:12,700 --> 00:02:16,100 line:-2
<c.magenta>支持HEVC意味着</c>
<c.magenta>可以同时使用H.264</c>


38
00:02:16,167 --> 00:02:18,967 line:-2
<c.magenta>和HEVC内容</c>
<c.magenta>在一个主播放列表里</c>


39
00:02:19,167 --> 00:02:21,433 line:-1
<c.magenta>那么我们找到了几个最佳实践</c>


40
00:02:22,500 --> 00:02:26,233 line:-2
<c.magenta>首先最重要的</c>
<c.magenta>就是使用CODECS属性</c>


41
00:02:26,600 --> 00:02:30,500 line:-2
<c.magenta>它能够防止旧的播放器</c>
<c.magenta>再次播放HEVC内容</c>


42
00:02:32,167 --> 00:02:36,667 line:-2
<c.magenta>第二个也很重要</c>
<c.magenta>要包含H.264内容</c>


43
00:02:37,167 --> 00:02:40,233 line:-1
<c.magenta>这是为了让旧播放器有内容可播</c>


44
00:02:42,367 --> 00:02:46,067 line:-2
<c.magenta>播放器可以切换播放</c>
<c.magenta>H.264和HEVC</c>


45
00:02:46,400 --> 00:02:49,033 line:-1
<c.magenta>但是如果两个版本的码率相似</c>


46
00:02:49,100 --> 00:02:52,067 line:-1
<c.magenta>播放器通常优先选择HEVC内容</c>


47
00:02:52,433 --> 00:02:57,733 line:-2
<c.magenta>H.264内容可以是fMP4格式</c>
<c.magenta>以最大化兼容性</c>


48
00:02:58,000 --> 00:03:01,133 line:-1
<c.magenta>保持H.264在传送流</c>


49
00:03:01,500 --> 00:03:04,000 line:-2
<c.magenta>最后一点</c>
<c.magenta>是同样使用于</c>


50
00:03:04,067 --> 00:03:07,833 line:-2
<c.magenta>特技播放的规则</c>
<c.magenta>I-frame-only</c>


51
00:03:08,767 --> 00:03:12,200 line:-2
<c.magenta>除了支持HEVC</c>
<c.magenta>我们还添加了</c>


52
00:03:12,267 --> 00:03:14,967 line:-1
<c.magenta>另一种字幕格式MSC</c>


53
00:03:15,767 --> 00:03:18,667 line:0
<c.magenta>如果想了解更多</c>
<c.magenta>IMSC1的支持情况</c>


54
00:03:18,733 --> 00:03:22,400 line:0
<c.magenta>可以看看今年一场</c>
<c.magenta>名为HLS优势的演讲</c>


55
00:03:23,433 --> 00:03:27,133 line:0
<c.magenta>IMSC1基于TTML</c>
<c.magenta>计时文本标记语言</c>


56
00:03:27,367 --> 00:03:32,200 line:0
<c.magenta>它可以兼容EBU和SMPTE规则</c>


57
00:03:34,067 --> 00:03:36,667 line:-1
<c.magenta>现在我们讨论字幕的最佳实践</c>


58
00:03:37,967 --> 00:03:42,133 line:-2
<c.magenta>虽然支持IMSC文本配置</c>
<c.magenta>但是IMSC内容</c>


59
00:03:42,200 --> 00:03:46,367 line:-2
<c.magenta>必须是fMP4格式</c>
<c.magenta>不能是纯文本格式</c>


60
00:03:47,367 --> 00:03:49,500 line:-1
<c.magenta>WebVTT跟过去一样</c>


61
00:03:49,567 --> 00:03:54,600 line:-2
<c.magenta>是文本文件 拓展名通常为</c>
<c.magenta>.VTT或.webVTT</c>


62
00:03:55,133 --> 00:03:58,500 line:-2
<c.magenta>要知道你可以</c>
<c.magenta>把IMSC和webVTT</c>


63
00:03:58,567 --> 00:04:03,433 line:-2
<c.magenta>与H.264和HEVC任意组合</c>
<c.magenta>它们之间完全独立</c>


64
00:04:04,000 --> 00:04:07,633 line:-2
<c.magenta>一定要使用</c>
<c.magenta>IMSC1 CODECS值</c>


65
00:04:08,000 --> 00:04:11,733 line:-2
<c.magenta>这个值可以保证</c>
<c.magenta>老用户不会注意到有变化</c>


66
00:04:11,867 --> 00:04:14,367 line:-1
<c.magenta>但是为了向后兼容最大化</c>


67
00:04:14,500 --> 00:04:17,033 line:-1
<c.magenta>这个值不能用于webVTT</c>


68
00:04:18,466 --> 00:04:20,966 line:-2
<c.magenta>我们换个话题</c>
<c.magenta>谈一谈HLS工具</c>


69
00:04:21,033 --> 00:04:22,533 line:-1
<c.magenta>还有我们做出的改变</c>


70
00:04:23,233 --> 00:04:25,333 line:-1
<c.magenta>这些工具都能在开发者网站上使用</c>


71
00:04:25,400 --> 00:04:28,667 line:-1
<c.magenta>可以在刚刚说过的网址上找到</c>


72
00:04:28,733 --> 00:04:30,967 line:-1
<c.magenta>developer.apple.com/streaming</c>


73
00:04:32,267 --> 00:04:34,600 line:-1
<c.magenta>这些工具大致分为三类</c>


74
00:04:34,733 --> 00:04:36,833 line:-1
<c.magenta>音频视频的分段工具</c>


75
00:04:37,367 --> 00:04:40,567 line:-1
<c.magenta>内容验证和生成验证报告的工具</c>


76
00:04:40,900 --> 00:04:45,200 line:-2
<c.magenta>最后是创建字幕</c>
<c.magenta>iv3元数据和主列表的工具</c>


77
00:04:45,767 --> 00:04:48,800 line:-1
<c.magenta>验证器不会检测级别较低的码流</c>


78
00:04:48,867 --> 00:04:50,567 line:-1
<c.magenta>所以就要使用第三方工具</c>


79
00:04:50,633 --> 00:04:53,233 line:-1
<c.magenta>在你觉得编码器出问题的时候</c>


80
00:04:53,800 --> 00:04:56,767 line:-2
<c.magenta>现在看看我们对工具</c>
<c.magenta>做了哪些具体的改变</c>


81
00:04:58,400 --> 00:04:59,933 line:-1
<c.magenta>首先我们添加了</c>


82
00:05:00,000 --> 00:05:03,533 line:-2
<c.magenta>MediaStreamValidator功能</c>
<c.magenta>用来检测本地文件</c>


83
00:05:03,767 --> 00:05:07,367 line:-2
<c.magenta>不再需要用HTTP服务器</c>
<c.magenta>去验证媒体流</c>


84
00:05:08,867 --> 00:05:11,467 line:-2
<c.magenta>如果是直接文件存取</c>
<c.magenta>就可以用这种方法检测</c>


85
00:05:11,600 --> 00:05:15,367 line:-2
<c.magenta>可以用相对路径</c>
<c.magenta>绝对路径或文件URL</c>


86
00:05:16,067 --> 00:05:20,533 line:-2
<c.magenta>但是要注意的是</c>
<c.magenta>不要混淆文件URL和HTTP</c>


87
00:05:20,600 --> 00:05:22,733 line:-1
<c.magenta>就是如果主列表是文件路径</c>


88
00:05:23,067 --> 00:05:27,400 line:-2
<c.magenta>那么它指向的媒体列表</c>
<c.magenta>就不能是HTTP URL</c>


89
00:05:28,033 --> 00:05:31,533 line:-2
<c.magenta>当然我们也为这些工具</c>
<c.magenta>增添了HEVC支持</c>


90
00:05:32,333 --> 00:05:35,200 line:-1
<c.magenta>我们还对这些工具做了很多改进</c>


91
00:05:35,300 --> 00:05:38,167 line:-2
<c.magenta>主要是MediaStreamValidator</c>
<c.magenta>和HLS报告</c>


92
00:05:38,733 --> 00:05:40,600 line:-1
<c.magenta>对媒体流做了更多研究</c>


93
00:05:41,033 --> 00:05:42,567 line:-1
<c.magenta>例子太多 比如</c>


94
00:05:42,633 --> 00:05:44,667 line:-2
<c.magenta>我们正在验证</c>
<c.magenta>CODEC的使用</c>


95
00:05:45,633 --> 00:05:48,833 line:-1
<c.magenta>在验证期间能更好地处理流错误</c>


96
00:05:49,100 --> 00:05:51,233 line:-1
<c.magenta>并且让变量和版本的排序</c>


97
00:05:51,300 --> 00:05:53,067 line:-1
<c.magenta>在报告中更加一致</c>


98
00:05:55,500 --> 00:05:58,867 line:-2
<c.magenta>我们添加了几个新选项</c>
<c.magenta>这里我只讲三个</c>


99
00:05:59,800 --> 00:06:02,667 line:-2
<c.magenta>第一个是描述选项</c>
<c.magenta>在MediaStreamValidator</c>


100
00:06:03,533 --> 00:06:07,133 line:-2
<c.magenta>流的URL不一定能</c>
<c.magenta>清楚表明它的内容</c>


101
00:06:07,467 --> 00:06:10,433 line:-1
<c.magenta>这个选项可以让你添加更多描述文本</c>


102
00:06:10,667 --> 00:06:13,733 line:-1
<c.magenta>比如某个剧第二季第五集</c>


103
00:06:14,133 --> 00:06:16,933 line:-2
<c.magenta>文本会显示在报告上方</c>
<c.magenta>靠近URL的位置</c>


104
00:06:18,200 --> 00:06:22,433 line:-2
<c.magenta>对HLS报告</c>
<c.magenta>我们添加了新的选项列</c>


105
00:06:23,200 --> 00:06:25,100 line:-1
<c.magenta>我们以往的方法</c>


106
00:06:25,167 --> 00:06:29,333 line:-2
<c.magenta>是给每列各自的选项</c>
<c.magenta>现在有了列选项</c>


107
00:06:29,400 --> 00:06:31,500 line:-1
<c.magenta>就可以提取一串列标识符</c>


108
00:06:32,067 --> 00:06:34,433 line:-1
<c.magenta>要找到可用的列标识符</c>


109
00:06:34,500 --> 00:06:36,967 line:-2
<c.magenta>可以通过Help选项</c>
<c.magenta>或在主页上查看</c>


110
00:06:37,767 --> 00:06:41,467 line:-2
<c.magenta>赋予数据id值的</c>
<c.magenta>旧id和pl选项</c>


111
00:06:41,533 --> 00:06:43,500 line:-2
<c.magenta>和播放列表码率</c>
<c.magenta>现在依然支持</c>


112
00:06:43,567 --> 00:06:46,300 line:-2
<c.magenta>但是为了支持列标识符</c>
<c.magenta>就弃用了</c>


113
00:06:46,733 --> 00:06:50,267 line:-2
<c.magenta>它们的列标识符</c>
<c.magenta>只有id和pl</c>


114
00:06:51,367 --> 00:06:54,633 line:-2
<c.magenta>去年我们添加了</c>
<c.magenta>hdcp-level支持</c>


115
00:06:54,833 --> 00:06:57,767 line:-2
<c.magenta>却忘了说</c>
<c.magenta>hdcp-level选项是在</c>


116
00:06:57,833 --> 00:06:59,767 line:-1
<c.magenta>MediaFileSegmenter上</c>


117
00:06:59,833 --> 00:07:02,533 line:-1
<c.magenta>它让你可以设置hdcp-level</c>


118
00:07:03,233 --> 00:07:07,967 line:-2
<c.magenta>hdcp-level包含于Plist</c>
<c.magenta>由MediaFileSegmenter生成</c>


119
00:07:08,567 --> 00:07:11,433 line:-2
<c.magenta>你可以传递Plist</c>
<c.magenta>给variantplaylistcreator</c>


120
00:07:11,500 --> 00:07:15,667 line:-2
<c.magenta>从而在生成的主列表中</c>
<c.magenta>获取hdcp-level属性</c>


121
00:07:18,133 --> 00:07:19,967 line:0
<c.magenta>快速浏览下这个样本报告</c>


122
00:07:20,633 --> 00:07:22,067 line:0
<c.magenta>注意第二行</c>


123
00:07:23,333 --> 00:07:26,767 line:0
<c.magenta>来自传递给</c>
<c.magenta>MediaStreamValidator的描述选项</c>


124
00:07:27,767 --> 00:07:30,467 line:0
<c.magenta>注意这里加入了CODEC列</c>


125
00:07:30,700 --> 00:07:34,400 line:0
<c.magenta>所以你能看到</c>
<c.magenta>哪些变量是H.264和HEVC</c>


126
00:07:36,300 --> 00:07:40,067 line:0
<c.magenta>这里的AVC是H.264的别名</c>


127
00:07:40,133 --> 00:07:43,667 line:0
<c.magenta>这样就能清楚的区别</c>
<c.magenta>这两种CODEC类型</c>


128
00:07:45,533 --> 00:07:48,967 line:0
<c.magenta>在更改变量和版本的顺序时</c>


129
00:07:49,200 --> 00:07:53,367 line:0
<c.magenta>我们将音频 CC字幕</c>
<c.magenta>和字幕翻译区分开来</c>


130
00:07:54,900 --> 00:07:56,033 line:-1
<c.magenta>总的来说</c>


131
00:07:56,800 --> 00:08:00,500 line:-2
<c.magenta>记住这个网址</c>
<c.magenta>developer.apple.com/streaming</c>


132
00:08:01,033 --> 00:08:03,700 line:-1
<c.magenta>你要知道的一切 这里都能找到</c>


133
00:08:04,133 --> 00:08:07,333 line:-2
<c.magenta>除了各种文档</c>
<c.magenta>它还有样本流的链接</c>


134
00:08:07,400 --> 00:08:11,067 line:-2
<c.magenta>工具下载链接</c>
<c.magenta>以往HLS视频的链接</c>


135
00:08:11,200 --> 00:08:13,900 line:-2
<c.magenta>FairPlayStreaming</c>
<c.magenta>的相关内容等</c>


136
00:08:14,467 --> 00:08:16,100 line:-1
<c.magenta>我建议你们都去读一读</c>


137
00:08:16,167 --> 00:08:20,300 line:-2
<c.magenta>Apple的HLS编写规范</c>
<c.magenta>和HLS规范</c>


138
00:08:21,733 --> 00:08:23,067 line:-1
<c.magenta>要了解更多</c>


139
00:08:23,233 --> 00:08:24,833 line:-1
<c.magenta>请参阅本场演讲的网页</c>


140
00:08:25,100 --> 00:08:30,233 line:-1
<c.magenta>developer.apple.com/wwdc17/515</c>


141
00:08:33,433 --> 00:08:38,100 line:-2
<c.magenta>还有几场相关的视频演讲</c>
<c.magenta>HTTP流媒体优势</c>


142
00:08:39,799 --> 00:08:42,866 line:-2
<c.magenta>这场演讲深入探讨</c>
<c.magenta>HEVC和IMSC1</c>


143
00:08:42,933 --> 00:08:44,867 line:-1
<c.magenta>以及其他有趣的话题</c>


144
00:08:45,200 --> 00:08:48,967 line:-1
<c.magenta>HTT流媒体错误处理的最佳实践</c>


145
00:08:49,533 --> 00:08:52,233 line:-1
<c.magenta>会帮助你了解如何把你的服务器</c>


146
00:08:52,300 --> 00:08:53,967 line:-1
<c.magenta>变成更好的HLS服务器</c>


147
00:08:54,600 --> 00:08:59,200 line:-2
<c.magenta>这些视频都可以在网页</c>
<c.magenta>或WWDC应用中观看</c>


148
00:09:00,200 --> 00:09:01,667 line:-1
<c.magenta>希望你们有所收获</c>


149
00:09:01,767 --> 00:09:02,733 line:-1
<c.magenta>谢谢观看</c>

