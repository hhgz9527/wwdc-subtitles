1
00:00:17,518 --> 00:00:19,152 line:0
<c.magenta>（照片API新特性）</c>


2
00:00:20,320 --> 00:00:22,155 line:0
<c.magenta>下午好</c>


3
00:00:23,490 --> 00:00:25,926 line:-1
<c.magenta>很高兴今天在这里看到这么多人</c>


4
00:00:26,360 --> 00:00:29,930 line:-2
<c.magenta>来观看演讲505</c>
<c.magenta>“照片API新特性”</c>


5
00:00:30,097 --> 00:00:33,400 line:-2
<c.magenta>我叫Eric Hanson</c>
<c.magenta>是照片平台的传道者</c>


6
00:00:33,700 --> 00:00:35,269 line:-1
<c.magenta>今天下午我将在这里</c>


7
00:00:35,335 --> 00:00:37,871 line:-2
<c.magenta>和我的两位同事一起</c>
<c.magenta>他们都来自照片工程师团队</c>


8
00:00:38,438 --> 00:00:41,375 line:-2
<c.magenta>来讨论关于在照片应用里很多</c>
<c.magenta>很多全新的强大功能</c>


9
00:00:41,441 --> 00:00:44,878 line:-1
<c.magenta>在iOS以及macOS High Sierra里</c>


10
00:00:46,380 --> 00:00:50,150 line:-2
<c.magenta>所以 显然 我们齐聚一堂</c>
<c.magenta>是因为我们都关注摄影</c>


11
00:00:51,518 --> 00:00:54,454 line:-2
<c.magenta>并且我们的用户</c>
<c.magenta>肯定你们大多数也知道</c>


12
00:00:54,521 --> 00:00:56,557 line:-1
<c.magenta>都极为关注摄影</c>


13
00:00:56,924 --> 00:00:59,893 line:-1
<c.magenta>每天在世界各地</c>


14
00:00:59,960 --> 00:01:04,063 line:-1
<c.magenta>iOS设备会捕获数以百万计的照片</c>


15
00:01:04,798 --> 00:01:08,068 line:-1
<c.magenta>因此库在不断增加</c>


16
00:01:08,135 --> 00:01:13,707 line:-1
<c.magenta>充满大量回忆和有意义的瞬间</c>


17
00:01:14,007 --> 00:01:17,144 line:-1
<c.magenta>用户们重温时将会非常愉快</c>


18
00:01:17,878 --> 00:01:22,850 line:-2
<c.magenta>因此我们将谈谈如何在应用里</c>
<c.magenta>创建美好的体验</c>


19
00:01:23,250 --> 00:01:25,319 line:-1
<c.magenta>并如何集成到Photo Library中</c>


20
00:01:25,385 --> 00:01:29,690 line:-2
<c.magenta>我们有一些非常棒的全新API</c>
<c.magenta>能让这种操作变得非常简单</c>


21
00:01:31,058 --> 00:01:33,093 line:-1
<c.magenta>我们还想讲讲</c>


22
00:01:33,794 --> 00:01:36,530 line:-1
<c.magenta>如何在应用中高效达到这个目的</c>


23
00:01:36,597 --> 00:01:40,334 line:-1
<c.magenta>并确保应用里的响应速度</c>


24
00:01:40,400 --> 00:01:42,202 line:-1
<c.magenta>是尽可能快的</c>


25
00:01:42,503 --> 00:01:44,404 line:-1
<c.magenta>我们也会讲这部分内容</c>


26
00:01:45,739 --> 00:01:48,642 line:-1
<c.magenta>最后 我们想要以一种</c>


27
00:01:49,009 --> 00:01:51,912 line:-1
<c.magenta>不违反用户对我们的信任的方式</c>


28
00:01:52,212 --> 00:01:54,781 line:-1
<c.magenta>我们不会强迫用户放弃隐私</c>


29
00:01:55,048 --> 00:01:59,753 line:-2
<c.magenta>只因为他们想把自己的照片</c>
<c.magenta>集成到你的应用中</c>


30
00:02:00,320 --> 00:02:01,955 line:-1
<c.magenta>这方面内容我们也会讲到</c>


31
00:02:02,456 --> 00:02:05,125 line:-2
<c.magenta>讲完这最后一点</c>
<c.magenta>我想欢迎上台的是</c>


32
00:02:05,826 --> 00:02:07,794 line:-1
<c.magenta>我的第一位在照片工程团队的同事</c>


33
00:02:07,861 --> 00:02:10,130 line:-2
<c.magenta>Hasan Adil</c>
<c.magenta>Hasan</c>


34
00:02:14,134 --> 00:02:14,968 line:-1
<c.magenta>谢谢你 Eric</c>


35
00:02:16,570 --> 00:02:18,372 line:-1
<c.magenta>大家好 很高兴见到你们</c>


36
00:02:21,441 --> 00:02:24,878 line:-2
<c.magenta>UIImagePickerController</c>
<c.magenta>是一个简单好用的API</c>


37
00:02:25,078 --> 00:02:28,248 line:-1
<c.magenta>可以在你的应用里选择照片和视频</c>


38
00:02:29,183 --> 00:02:33,353 line:-1
<c.magenta>iOS 11有许多优秀的改进和新功能</c>


39
00:02:33,420 --> 00:02:35,589 line:-1
<c.magenta>今天我很激动能和大家分享</c>


40
00:02:35,822 --> 00:02:37,291 line:-1
<c.magenta>（照片-时刻-相机胶卷）</c>


41
00:02:37,357 --> 00:02:38,859 line:-1
<c.magenta>（我的相簿）</c>


42
00:02:38,926 --> 00:02:43,397 line:-2
<c.magenta>在Apple 我们十分关心</c>
<c.magenta>用户的隐私和安全</c>


43
00:02:46,166 --> 00:02:49,837 line:-2
<c.magenta>因此 任何显示</c>
<c.magenta>UIImagePickerController时</c>


44
00:02:50,137 --> 00:02:51,371 line:-1
<c.magenta>我们都要求</c>


45
00:02:51,605 --> 00:02:55,375 line:-1
<c.magenta>获得用户的授权来使用整个图库</c>


46
00:02:55,542 --> 00:02:57,945 line:-1
<c.magenta>为了选择一张照片或视频</c>


47
00:02:58,011 --> 00:02:59,880 line:-2
<c.magenta>（“VACATION DIARY”</c>
<c.magenta>想要访问你的照片）</c>


48
00:02:59,947 --> 00:03:02,482 line:-2
<c.magenta>我想你们对这个警告信息</c>
<c.magenta>都非常熟悉</c>


49
00:03:03,851 --> 00:03:05,619 line:-1
<c.magenta>这在应用中产生了摩擦</c>


50
00:03:06,420 --> 00:03:08,856 line:-1
<c.magenta>并让用户放弃了一级隐私</c>


51
00:03:09,022 --> 00:03:10,657 line:-1
<c.magenta>这也许并不是他们想要做的</c>


52
00:03:11,391 --> 00:03:15,629 line:-2
<c.magenta>并且程序无法执行</c>
<c.magenta>即便它有很多优秀的功能</c>


53
00:03:15,896 --> 00:03:17,631 line:-1
<c.magenta>只因为用户不想让程序访问</c>


54
00:03:18,465 --> 00:03:20,534 line:-1
<c.magenta>我们认为自己可以做得更好</c>


55
00:03:21,668 --> 00:03:26,340 line:-2
<c.magenta>因此在iOS 11 我们重新设计了</c>
<c.magenta>隐私安全的基础</c>


56
00:03:26,607 --> 00:03:28,108 line:-1
<c.magenta>关于UIImagePickerController</c>


57
00:03:29,209 --> 00:03:30,644 line:-1
<c.magenta>我们一开始定了三个目标</c>


58
00:03:31,879 --> 00:03:34,014 line:-1
<c.magenta>让用户决定内容</c>


59
00:03:35,282 --> 00:03:38,318 line:-1
<c.magenta>在应用里创造良好的用户体验</c>


60
00:03:39,987 --> 00:03:44,958 line:-1
<c.magenta>第三 给用户更高级别隐私</c>


61
00:03:45,893 --> 00:03:51,465 line:-2
<c.magenta>因此 我很高兴地宣布 在iOS 11</c>
<c.magenta>这个警告不会出现</c>


62
00:03:52,799 --> 00:03:53,867 line:-1
<c.magenta>就直接成功运行</c>


63
00:03:58,038 --> 00:03:59,840 line:-2
<c.magenta>我们来看一个演示</c>
<c.magenta>可以清楚地了解</c>


64
00:04:01,175 --> 00:04:03,644 line:-1
<c.magenta>这是有一个应用 我刚从App Store下载</c>


65
00:04:03,744 --> 00:04:05,312 line:-1
<c.magenta>我很高兴可以运行它</c>


66
00:04:05,512 --> 00:04:07,681 line:-1
<c.magenta>我很充实 今天在WWDC过得很高兴</c>


67
00:04:07,814 --> 00:04:09,316 line:-1
<c.magenta>有点紧张 不过不要紧</c>


68
00:04:09,983 --> 00:04:11,418 line:-1
<c.magenta>我想附上一张照片</c>


69
00:04:12,052 --> 00:04:12,886 line:-1
<c.magenta>让我们来看一下</c>


70
00:04:12,953 --> 00:04:16,089 line:-2
<c.magenta>在iOS 11中启动UIImagePicker时</c>
<c.magenta>会是什么样子</c>


71
00:04:16,990 --> 00:04:18,024 line:-1
<c.magenta>直接成功了</c>


72
00:04:18,791 --> 00:04:23,163 line:-2
<c.magenta>在 iOS 11 UIImagePickerController</c>
<c.magenta>成为一个自动处理API</c>


73
00:04:23,830 --> 00:04:28,836 line:-1
<c.magenta>这指的是 我们显示API里的内容</c>


74
00:04:29,036 --> 00:04:32,072 line:-1
<c.magenta>从一个自动处理的沙盒和安全环境中</c>


75
00:04:32,539 --> 00:04:36,009 line:-1
<c.magenta>应用不再访问用户的Photo Library</c>


76
00:04:37,211 --> 00:04:41,481 line:-2
<c.magenta>只有用户本人可以和</c>
<c.magenta>UIImagePickerController UI进行互动</c>


77
00:04:43,217 --> 00:04:44,751 line:-1
<c.magenta>当用户做出了一个选择</c>


78
00:04:45,319 --> 00:04:49,156 line:-2
<c.magenta>我们取出选中的照片或视频</c>
<c.magenta>发送到你的应用</c>


79
00:04:50,657 --> 00:04:53,227 line:-1
<c.magenta>我们认为这将消除应用中的摩擦</c>


80
00:04:53,427 --> 00:04:56,630 line:-1
<c.magenta>并且让用户有了非常高级别的隐私</c>


81
00:04:57,397 --> 00:05:00,868 line:-1
<c.magenta>因为不存在授权 也不会有询问</c>


82
00:05:01,768 --> 00:05:04,505 line:-1
<c.magenta>希望大家喜欢这点 使用起来非常容易</c>


83
00:05:04,605 --> 00:05:07,341 line:-1
<c.magenta>你不用多做什么 直接操作即可</c>


84
00:05:10,077 --> 00:05:12,012 line:-1
<c.magenta>照片包含丰富的元数据</c>


85
00:05:12,446 --> 00:05:14,181 line:-1
<c.magenta>包括创建日期</c>


86
00:05:14,481 --> 00:05:15,916 line:0
<c.magenta>照片的格式</c>


87
00:05:16,149 --> 00:05:17,851 line:0
<c.magenta>以及其他不同的元数据</c>


88
00:05:18,519 --> 00:05:21,455 line:0
<c.magenta>在iOS 11 获取这些信息变得非常容易</c>


89
00:05:22,789 --> 00:05:24,525 line:0
<c.magenta>我们现在提供一个全新的键</c>


90
00:05:24,591 --> 00:05:27,060 line:0
<c.magenta>包含所有</c>
<c.magenta>UIImagePickerController的结果</c>


91
00:05:27,227 --> 00:05:30,697 line:0
<c.magenta>该键被称为</c>
<c.magenta>UIImagePickerControllerImageURL</c>


92
00:05:32,833 --> 00:05:35,335 line:0
<c.magenta>该URL是个文件URL</c>


93
00:05:35,602 --> 00:05:38,272 line:0
<c.magenta>指向一个应用中的临时文件</c>


94
00:05:39,139 --> 00:05:41,308 line:0
<c.magenta>如果想之后继续操作</c>


95
00:05:41,675 --> 00:05:44,311 line:0
<c.magenta>我们建议把文件移动到更永久的位置</c>


96
00:05:44,711 --> 00:05:45,546 line:0
<c.magenta>所以它会一直在那里</c>


97
00:05:46,747 --> 00:05:48,348 line:0
<c.magenta>你可以使用一个URL</c>


98
00:05:48,615 --> 00:05:52,953 line:0
<c.magenta>也可以把NSData读入应用</c>
<c.magenta>并按照需要进行处理</c>


99
00:05:59,059 --> 00:06:03,063 line:0
<c.magenta>在iOS 11 我们还为照片引进了</c>
<c.magenta>一种新格式叫HEIF</c>


100
00:06:04,264 --> 00:06:08,769 line:0
<c.magenta>我们意识到生态系统完全接受HEIF</c>
<c.magenta>需要一段时间</c>


101
00:06:09,002 --> 00:06:12,105 line:0
<c.magenta>我们利用UIImagePickerController</c>
<c.magenta>让它变得非常容易</c>


102
00:06:13,607 --> 00:06:16,677 line:0
<c.magenta>我们有了一个新属性</c>
<c.magenta>名为imageExportPresent</c>


103
00:06:17,945 --> 00:06:19,413 line:-1
<c.magenta>它可以被设为两种类型</c>


104
00:06:19,546 --> 00:06:22,382 line:-2
<c.magenta>可以设为兼容模式</c>
<c.magenta>也可以设为当前模式</c>


105
00:06:22,683 --> 00:06:23,517 line:-1
<c.magenta>我们来看一下</c>


106
00:06:25,552 --> 00:06:26,920 line:-1
<c.magenta>在兼容模式</c>


107
00:06:27,654 --> 00:06:32,926 line:-1
<c.magenta>如果用户选中的源照片是HEIF格式</c>


108
00:06:33,560 --> 00:06:36,897 line:-2
<c.magenta>我们将输送一个Jpeg</c>
<c.magenta>并给出它的Jpeg版本</c>


109
00:06:38,131 --> 00:06:40,467 line:-1
<c.magenta>这也是该属性的默认值</c>


110
00:06:40,968 --> 00:06:44,137 line:-2
<c.magenta>如果不需要有什么改变</c>
<c.magenta>就什么都不用做</c>


111
00:06:45,606 --> 00:06:50,511 line:0
<c.magenta>然而 如果需要照片格式</c>
<c.magenta>和拍摄时相同</c>


112
00:06:50,811 --> 00:06:52,012 line:0
<c.magenta>只需把属性值设为当前模式</c>


113
00:06:52,212 --> 00:06:55,082 line:0
<c.magenta>将会输出和Photo Library里</c>
<c.magenta>相同格式的照片</c>


114
00:06:55,215 --> 00:06:57,784 line:0
<c.magenta>将会得到HEIF格式 可以继续处理</c>


115
00:06:59,219 --> 00:07:00,053 line:0
<c.magenta>（获取视频）</c>


116
00:07:00,120 --> 00:07:03,557 line:0
<c.magenta>在选择视频方面 我们有很好的改进</c>


117
00:07:05,425 --> 00:07:07,227 line:0
<c.magenta>但暂时把这部分内容放在一边</c>


118
00:07:08,328 --> 00:07:11,598 line:0
<c.magenta>AVFoundation是Apple的框架</c>
<c.magenta>服务于丰富编辑</c>


119
00:07:11,665 --> 00:07:13,433 line:0
<c.magenta>以及照片播放</c>


120
00:07:14,468 --> 00:07:19,239 line:-2
<c.magenta>AVFoundation拥有导出预设的丰富集合</c>
<c.magenta>也可以说是格式</c>


121
00:07:20,674 --> 00:07:21,775 line:-1
<c.magenta>我很高兴宣布</c>


122
00:07:22,176 --> 00:07:24,811 line:-2
<c.magenta>UIImagePickerController</c>
<c.magenta>支持所有格式</c>


123
00:07:26,446 --> 00:07:28,949 line:-2
<c.magenta>我们有一个新属性叫作</c>
<c.magenta>videoExportPreset</c>


124
00:07:30,651 --> 00:07:33,654 line:-1
<c.magenta>可以用这种方法告诉我们</c>


125
00:07:33,820 --> 00:07:37,157 line:-1
<c.magenta>你想要选中的视频以哪种格式返回</c>


126
00:07:38,625 --> 00:07:39,626 line:-1
<c.magenta>让我们来看一个例子</c>


127
00:07:42,829 --> 00:07:47,434 line:0
<c.magenta>导入AVFoundation后 将会创建一个</c>
<c.magenta>UIImagePickerController的实例</c>


128
00:07:47,734 --> 00:07:49,837 line:0
<c.magenta>并告诉我们想要哪种格式</c>


129
00:07:51,038 --> 00:07:54,007 line:0
<c.magenta>这里我要求最高品质的视频</c>


130
00:07:55,409 --> 00:07:56,410 line:0
<c.magenta>然后显示选取器</c>


131
00:07:56,476 --> 00:07:59,847 line:0
<c.magenta>当用户做出选择时</c>
<c.magenta>无论是什么格式</c>


132
00:08:00,180 --> 00:08:04,151 line:0
<c.magenta>我们会对其进行交叉编译</c>
<c.magenta>得到匹配格式 然后返回给用户</c>


133
00:08:05,085 --> 00:08:07,821 line:0
<c.magenta>这将非常有用</c>
<c.magenta>对于想让视频返回</c>


134
00:08:07,888 --> 00:08:10,123 line:0
<c.magenta>用最初形成的原始格式</c>


135
00:08:12,025 --> 00:08:14,828 line:0
<c.magenta>关于可用预设的完整清单</c>


136
00:08:15,429 --> 00:08:18,765 line:0
<c.magenta>请查看该接口 叫作</c>
<c.magenta>AVAssetExportSession</c>


137
00:08:20,000 --> 00:08:22,069 line:0
<c.magenta>或者到实验室来找我们</c>
<c.magenta>我们将竭诚帮助你</c>


138
00:08:23,403 --> 00:08:25,339 line:0
<c.magenta>（保存照片和视频）</c>


139
00:08:25,405 --> 00:08:28,041 line:0
<c.magenta>关于我之前讲到的增加隐私</c>


140
00:08:28,108 --> 00:08:32,846 line:0
<c.magenta>我们还深入研究了</c>
<c.magenta>如何在Photo Library里添加内容</c>


141
00:08:34,081 --> 00:08:35,883 line:0
<c.magenta>现在 既然我们已经实现了无缝选取</c>


142
00:08:36,450 --> 00:08:38,751 line:0
<c.magenta>我们应该也可以做到让添加更完美</c>


143
00:08:40,020 --> 00:08:42,121 line:0
<c.magenta>因此 在iOS 11</c>


144
00:08:42,322 --> 00:08:44,791 line:0
<c.magenta>如果采用这两种方法的任意一种</c>


145
00:08:45,058 --> 00:08:49,296 line:0
<c.magenta>保存一张照片或一段视频</c>
<c.magenta>到用户的图片库</c>


146
00:08:49,763 --> 00:08:52,766 line:0
<c.magenta>我们有一个全新的安全模型</c>
<c.magenta>以及权限级别</c>


147
00:08:54,635 --> 00:08:57,704 line:0
<c.magenta>这两种方法任意一种的权限级别</c>


148
00:08:57,771 --> 00:08:59,006 line:0
<c.magenta>在UIImagePickerController里</c>


149
00:08:59,540 --> 00:09:03,010 line:0
<c.magenta>一个叫作</c>
<c.magenta>UIImageWriteToSavePhotosAlbum</c>


150
00:09:03,210 --> 00:09:07,814 line:0
<c.magenta>另一个叫作UISaveVideoAtPath</c>
<c.magenta>ToSavedPhotosAlbum</c>


151
00:09:09,049 --> 00:09:10,851 line:0
<c.magenta>它们要求只添加授权</c>


152
00:09:11,652 --> 00:09:14,354 line:0
<c.magenta>对于用户来说是很小的要求</c>


153
00:09:14,555 --> 00:09:18,892 line:0
<c.magenta>因为这将允许你</c>
<c.magenta>添加内容到Photo Library 而不是读取</c>


154
00:09:19,426 --> 00:09:22,162 line:0
<c.magenta>我们认为用户很大可能会给出</c>


155
00:09:22,229 --> 00:09:23,197 line:-1
<c.magenta>这个权限</c>


156
00:09:24,531 --> 00:09:27,701 line:-2
<c.magenta>如前所述 如果有任何问题</c>
<c.magenta>请到实验室找我们</c>


157
00:09:29,837 --> 00:09:32,472 line:-2
<c.magenta>对于PhotoKit的用户</c>
<c.magenta>我们提供了一些很好的功能</c>


158
00:09:33,674 --> 00:09:37,110 line:-2
<c.magenta>现在对于每一个</c>
<c.magenta>UIImagePickerController的结果</c>


159
00:09:37,477 --> 00:09:40,080 line:-1
<c.magenta>如果你是PhotoKit用户</c>


160
00:09:41,815 --> 00:09:45,419 line:0
<c.magenta>我们会返回的PHAsset对象</c>
<c.magenta>该对象和用户选择相匹配</c>


161
00:09:46,820 --> 00:09:51,358 line:0
<c.magenta>这可以让API间的PhotoKit无缝集成</c>


162
00:09:52,159 --> 00:09:53,160 line:0
<c.magenta>让我们看一个例子</c>


163
00:09:53,794 --> 00:09:55,796 line:-1
<c.magenta>这里我实现了一个代理方法</c>


164
00:09:55,929 --> 00:09:57,731 line:-1
<c.magenta>UImagePickerController的代理方法</c>


165
00:09:58,866 --> 00:10:01,835 line:-2
<c.magenta>当获得结果词典时</c>
<c.magenta>有了一个全新的键</c>


166
00:10:01,902 --> 00:10:05,305 line:-2
<c.magenta>该键名为</c>
<c.magenta>UIImagePickerControllerPHAsset</c>


167
00:10:06,039 --> 00:10:09,676 line:0
<c.magenta>取得该键的值 该键将会成为资产对象</c>


168
00:10:09,877 --> 00:10:10,944 line:0
<c.magenta>将可以对其进行自由使用</c>


169
00:10:12,412 --> 00:10:15,649 line:0
<c.magenta>现在 与此同时</c>


170
00:10:16,183 --> 00:10:19,152 line:0
<c.magenta>之前我们弃用了ALAssetsLibrary框架</c>


171
00:10:20,254 --> 00:10:23,490 line:-1
<c.magenta>现在ALAssetsLibrary引用了URL</c>


172
00:10:23,557 --> 00:10:28,262 line:-2
<c.magenta>即我们之前传给你的使用了一个键名为</c>
<c.magenta>UIImagePickerController</c>


173
00:10:28,495 --> 00:10:30,864 line:-1
<c.magenta>引用URL现在也已被弃用</c>


174
00:10:32,466 --> 00:10:34,635 line:-2
<c.magenta>是的 PhotoKit非常好</c>
<c.magenta>你们会热爱它</c>


175
00:10:36,270 --> 00:10:39,840 line:-2
<c.magenta>我们认为通过这些改变</c>
<c.magenta>增强用户隐私</c>


176
00:10:40,607 --> 00:10:45,345 line:-2
<c.magenta>让UImagePickerController成为</c>
<c.magenta>更强大而功能齐全的API</c>


177
00:10:45,779 --> 00:10:49,149 line:-1
<c.magenta>将会满足市面上大部分应用的需求</c>


178
00:10:50,584 --> 00:10:52,653 line:-1
<c.magenta>然而 有时会出现</c>


179
00:10:52,853 --> 00:10:55,522 line:-1
<c.magenta>需要和照片框架进行更深入的集成</c>


180
00:10:56,323 --> 00:10:58,225 line:-1
<c.magenta>这时我们推荐PhotoKit</c>


181
00:10:59,026 --> 00:11:01,929 line:-1
<c.magenta>iOS 11中的PhotoKit有哪些新功能</c>


182
00:11:02,229 --> 00:11:04,331 line:-2
<c.magenta>请欢迎我的同事来讲解</c>
<c.magenta>Andreas Karlsson</c>


183
00:11:08,035 --> 00:11:08,869 line:-1
<c.magenta>谢谢你 Hasan</c>


184
00:11:13,340 --> 00:11:16,109 line:-1
<c.magenta>所以 和照片有关的应用一直以来</c>


185
00:11:16,176 --> 00:11:18,412 line:-1
<c.magenta>是App Store里最受欢迎的应用</c>


186
00:11:19,046 --> 00:11:22,349 line:-1
<c.magenta>既要功能优秀 也要良好的用户体验</c>


187
00:11:22,516 --> 00:11:24,017 line:-1
<c.magenta>才能赢得市场</c>


188
00:11:24,518 --> 00:11:25,686 line:-1
<c.magenta>今天我十分激动在这里</c>


189
00:11:25,752 --> 00:11:28,155 line:-1
<c.magenta>讲解我们在PhotoKit做出的改进</c>


190
00:11:28,555 --> 00:11:31,758 line:-1
<c.magenta>希望可以让你们写出更优秀的新功能</c>


191
00:11:32,059 --> 00:11:35,395 line:-1
<c.magenta>并让你们的应用更容易地增强用户体验</c>


192
00:11:36,363 --> 00:11:37,197 line:-1
<c.magenta>让我们马上开始</c>


193
00:11:37,331 --> 00:11:38,765 line:-1
<c.magenta>首先来看一下Live Photo效果</c>


194
00:11:39,099 --> 00:11:41,101 line:-1
<c.magenta>周一Keynote演讲上刚刚宣布</c>


195
00:11:42,302 --> 00:11:44,738 line:-1
<c.magenta>Live Photo效果包括这些循环</c>


196
00:11:45,072 --> 00:11:47,508 line:-1
<c.magenta>是通过仔细分析视频所创建的</c>


197
00:11:47,574 --> 00:11:52,045 line:-1
<c.magenta>并无缝和这些无止境循环缝合到一起</c>


198
00:11:53,080 --> 00:11:56,350 line:-1
<c.magenta>还包含这些弹跳 其工作原理相似</c>


199
00:11:56,416 --> 00:11:58,452 line:-1
<c.magenta>但是可以看到 在狗身上表现得更好</c>


200
00:11:59,419 --> 00:12:01,922 line:-1
<c.magenta>最后 是长时间曝光</c>


201
00:12:02,356 --> 00:12:05,158 line:-1
<c.magenta>它将分析Live Photo的视频帧</c>


202
00:12:05,325 --> 00:12:07,461 line:-1
<c.magenta>创建这些令人惊艳的静物</c>


203
00:12:09,129 --> 00:12:11,398 line:-2
<c.magenta>所以 我们相信用户将会</c>
<c.magenta>从中获得诸多乐趣</c>


204
00:12:11,465 --> 00:12:14,168 line:-2
<c.magenta>我们也十分期待看到</c>
<c.magenta>你们的应用里会出现的创新</c>


205
00:12:14,268 --> 00:12:16,370 line:-1
<c.magenta>在集成这些新的媒体类型时</c>


206
00:12:17,304 --> 00:12:19,473 line:-2
<c.magenta>所以 来看看该如何实现</c>
<c.magenta>以及一些代码</c>


207
00:12:21,975 --> 00:12:25,345 line:-1
<c.magenta>这些就是现存的PhotoKit媒体类型</c>


208
00:12:26,113 --> 00:12:28,715 line:-1
<c.magenta>它们都非常好 描述什么是资产</c>


209
00:12:28,949 --> 00:12:32,019 line:-1
<c.magenta>但是更重要的是 资产如何表现</c>


210
00:12:32,386 --> 00:12:33,854 line:-1
<c.magenta>让我来解释一下这句话的意思</c>


211
00:12:34,621 --> 00:12:36,323 line:-1
<c.magenta>如果用户拍摄了一段视频</c>


212
00:12:36,456 --> 00:12:40,427 line:-2
<c.magenta>他们会想要在你的应用里</c>
<c.magenta>观看并将该资产以视频方式使用</c>


213
00:12:41,028 --> 00:12:42,596 line:-1
<c.magenta>如果用户拍摄了一张Live Photo</c>


214
00:12:42,663 --> 00:12:46,333 line:-1
<c.magenta>会对静止部分和视频部分同等关注</c>


215
00:12:46,834 --> 00:12:49,436 line:-2
<c.magenta>因此用户会想要在应用中</c>
<c.magenta>看到该资产以Live Photo的方式呈现</c>


216
00:12:50,370 --> 00:12:53,707 line:-2
<c.magenta>目前为了实现这一点</c>
<c.magenta>请看这里有三种媒体类型</c>


217
00:12:53,807 --> 00:12:56,677 line:-2
<c.magenta>Image video和photoLive</c>
<c.magenta>来实现目标</c>


218
00:12:57,811 --> 00:13:00,547 line:-1
<c.magenta>Live Photo效果有一点复杂</c>


219
00:13:00,614 --> 00:13:04,117 line:-2
<c.magenta>为了更简化地达成目标</c>
<c.magenta>因为这如此重要</c>


220
00:13:04,751 --> 00:13:05,986 line:-1
<c.magenta>今年在iOS 11</c>


221
00:13:06,053 --> 00:13:10,190 line:-2
<c.magenta>我们引进了全新的PHAsset属性</c>
<c.magenta>名为playbackStyle</c>


222
00:13:11,525 --> 00:13:14,695 line:-2
<c.magenta>现在PlaybackStyle是唯一属性</c>
<c.magenta>可以查看和决定</c>


223
00:13:14,828 --> 00:13:17,064 line:-1
<c.magenta>要使用什么样的图片管理器API</c>


224
00:13:17,431 --> 00:13:18,966 line:-1
<c.magenta>用什么样的视图来表现</c>


225
00:13:19,233 --> 00:13:21,869 line:-1
<c.magenta>以及为该视图设置什么样UI限制</c>


226
00:13:23,270 --> 00:13:25,205 line:-1
<c.magenta>因此 我们更新了PhotoKit示例应用</c>


227
00:13:25,372 --> 00:13:27,140 line:-1
<c.magenta>包含所有这些新的播放风格</c>


228
00:13:27,474 --> 00:13:29,476 line:-1
<c.magenta>但我想更深入地介绍其中三种</c>


229
00:13:29,543 --> 00:13:32,813 line:-1
<c.magenta>它们和本次演讲的Live Photo效果相关</c>


230
00:13:33,647 --> 00:13:35,015 line:-1
<c.magenta>首先从imageAnimated开始</c>


231
00:13:36,884 --> 00:13:38,852 line:-2
<c.magenta>今年新出现的功能</c>
<c.magenta>在内置应用“照片”</c>


232
00:13:38,919 --> 00:13:41,221 line:-1
<c.magenta>是支持动画GIF播放</c>


233
00:13:46,426 --> 00:13:47,861 line:-1
<c.magenta>若要在你的应用中播放GIF</c>


234
00:13:48,428 --> 00:13:50,697 line:-1
<c.magenta>需要从图像管理器请求图像数据</c>


235
00:13:50,797 --> 00:13:53,700 line:-1
<c.magenta>然后使用图像IO和核心图形进行播放</c>


236
00:13:53,934 --> 00:13:57,171 line:-2
<c.magenta>现在 示例应用包含了</c>
<c.magenta>一个如何实现的例子</c>


237
00:13:57,271 --> 00:14:00,741 line:-1
<c.magenta>所以 若要播放GIF 请查看示例应用</c>


238
00:14:01,842 --> 00:14:03,977 line:-1
<c.magenta>接下来是Live Photo</c>


239
00:14:04,978 --> 00:14:07,247 line:-1
<c.magenta>Live Photos用户很关注Live Photos</c>


240
00:14:07,314 --> 00:14:10,417 line:-1
<c.magenta>因此在应用中正确表现它们非常重要</c>


241
00:14:10,484 --> 00:14:11,718 line:-1
<c.magenta>但也非常简单</c>


242
00:14:12,452 --> 00:14:15,856 line:-2
<c.magenta>所以 在这个例子里</c>
<c.magenta>从图像管理器请求一张Live Photo</c>


243
00:14:15,956 --> 00:14:19,326 line:-1
<c.magenta>然后设置PHLivePhotoView播放</c>


244
00:14:20,327 --> 00:14:21,962 line:-1
<c.magenta>设成Live Photo 回到视图</c>


245
00:14:22,029 --> 00:14:25,632 line:-1
<c.magenta>用户就可以轻触播放一张Live Photo</c>


246
00:14:25,699 --> 00:14:27,601 line:-2
<c.magenta>正如用户在内置“照片”应用</c>
<c.magenta>的操作一样</c>


247
00:14:27,935 --> 00:14:28,769 line:-1
<c.magenta>在你的应用里</c>


248
00:14:29,403 --> 00:14:31,872 line:-2
<c.magenta>PHLivePhotoView也可以和</c>
<c.magenta>Live Photos一起使用</c>


249
00:14:31,939 --> 00:14:33,440 line:-1
<c.magenta>在用户的Photo Library之外</c>


250
00:14:33,740 --> 00:14:36,577 line:-2
<c.magenta>举个例子 如果通过Web服务器</c>
<c.magenta>或类似的工具传输</c>


251
00:14:38,545 --> 00:14:40,747 line:-1
<c.magenta>最后 包含循环的视频</c>


252
00:14:40,848 --> 00:14:43,851 line:-2
<c.magenta>既包括弹跳 也包括循环的</c>
<c.magenta>Live Photo效果</c>


253
00:14:44,418 --> 00:14:45,619 line:-1
<c.magenta>今年所推出的</c>


254
00:14:46,987 --> 00:14:50,057 line:-2
<c.magenta>现在 在你的应用里播放这些</c>
<c.magenta>和播放普通视频非常相似</c>


255
00:14:50,123 --> 00:14:53,227 line:-2
<c.magenta>可以请求播放器项目</c>
<c.magenta>并使用AVFoundation播放</c>


256
00:14:53,560 --> 00:14:56,797 line:-2
<c.magenta>还可以使用AVPlayerLooper</c>
<c.magenta>取得循环效果</c>


257
00:14:59,066 --> 00:15:02,402 line:-2
<c.magenta>所以我希望你们看到</c>
<c.magenta>表现用户的媒体是多么简单</c>


258
00:15:02,469 --> 00:15:04,238 line:-1
<c.magenta>以他们真正想表现的方式</c>


259
00:15:04,404 --> 00:15:07,374 line:-2
<c.magenta>但我们更期待你们</c>
<c.magenta>在各自的应用中的创新表现</c>


260
00:15:07,541 --> 00:15:09,176 line:-1
<c.magenta>和这些全新的媒体类型相关</c>


261
00:15:10,477 --> 00:15:12,846 line:-2
<c.magenta>接下来 我想要讲讲</c>
<c.magenta>iCloud Photo Library</c>


262
00:15:15,182 --> 00:15:17,684 line:-1
<c.magenta>iCloud Photo Library非常好</c>


263
00:15:17,751 --> 00:15:20,587 line:-2
<c.magenta>因为现在用户可以把整个</c>
<c.magenta>Photo Library</c>


264
00:15:20,721 --> 00:15:21,555 line:-1
<c.magenta>装入口袋</c>


265
00:15:21,822 --> 00:15:25,492 line:-2
<c.magenta>对于一些图库非常大的用户来说</c>
<c.magenta>这个功能非常好</c>


266
00:15:26,493 --> 00:15:30,430 line:-2
<c.magenta>有些用户的Photo Library</c>
<c.magenta>会有超过十万张照片</c>


267
00:15:30,631 --> 00:15:32,165 line:-1
<c.magenta>实际上这很常见</c>


268
00:15:33,333 --> 00:15:35,135 line:-1
<c.magenta>什么样的用户会有那么多照片？</c>


269
00:15:35,235 --> 00:15:39,473 line:-2
<c.magenta>想要有十万张照片的话</c>
<c.magenta>则必须每天拍28张照片</c>


270
00:15:39,840 --> 00:15:42,142 line:-1
<c.magenta>坚持每天拍 一直拍十年</c>


271
00:15:42,543 --> 00:15:46,480 line:-2
<c.magenta>因此这些用户显然</c>
<c.magenta>非常喜欢相机和使用“相机”应用</c>


272
00:15:47,114 --> 00:15:50,484 line:-2
<c.magenta>但他们也倾向于下载和使用</c>
<c.magenta>很多照片相关的应用</c>


273
00:15:51,285 --> 00:15:54,421 line:-2
<c.magenta>这些用户对于这个房间里的我们</c>
<c.magenta>非常重要</c>


274
00:15:56,190 --> 00:16:00,227 line:-2
<c.magenta>现在想象 这些用户中的其中一员</c>
<c.magenta>在拍完每天的28张照片以后</c>


275
00:16:00,694 --> 00:16:02,863 line:-1
<c.magenta>他们会去App Store搜索有趣的应用</c>


276
00:16:03,397 --> 00:16:04,765 line:-1
<c.magenta>他们找到了你的应用</c>


277
00:16:05,465 --> 00:16:07,434 line:-1
<c.magenta>他们决定下载下来试试看</c>


278
00:16:07,835 --> 00:16:10,971 line:-2
<c.magenta>当他们开始使用你的应用时</c>
<c.magenta>首先看到的是这个</c>


279
00:16:14,708 --> 00:16:18,378 line:-2
<c.magenta>加载图标持续好几秒钟</c>
<c.magenta>可不是好的用户体验</c>


280
00:16:18,612 --> 00:16:21,315 line:-1
<c.magenta>该用户可能会马上卸载你的应用</c>


281
00:16:21,815 --> 00:16:23,584 line:-1
<c.magenta>或者更糟糕 给个差评</c>


282
00:16:24,952 --> 00:16:27,955 line:-1
<c.magenta>所以 你会想 我的应用不会这样做</c>


283
00:16:28,021 --> 00:16:32,559 line:-2
<c.magenta>如果出现这种情况 我在使用PhotoKit</c>
<c.magenta>该用户的图库非常之大</c>


284
00:16:32,926 --> 00:16:34,328 line:-1
<c.magenta>也许这就是必然结果</c>


285
00:16:36,430 --> 00:16:37,998 line:-1
<c.magenta>PhotoKit一开始设计</c>


286
00:16:38,065 --> 00:16:41,802 line:-2
<c.magenta>就是为了非常快速和高效地</c>
<c.magenta>操作大型Photo Library</c>


287
00:16:42,436 --> 00:16:44,505 line:-1
<c.magenta>但客户通常会犯一些错误</c>


288
00:16:44,638 --> 00:16:47,074 line:-1
<c.magenta>会意味着操作时间的差距</c>


289
00:16:47,407 --> 00:16:49,576 line:-1
<c.magenta>从10毫秒到10秒</c>


290
00:16:50,944 --> 00:16:52,546 line:-1
<c.magenta>所以该如何修正？</c>


291
00:16:52,613 --> 00:16:55,482 line:-1
<c.magenta>由于很容易结束一个耗时太久的东西</c>


292
00:16:56,049 --> 00:17:00,254 line:-2
<c.magenta>第一步即为用一个巨大的</c>
<c.magenta>Photo Library测试你的应用</c>


293
00:17:01,588 --> 00:17:03,290 line:-1
<c.magenta>我们讲过这样做有些难度</c>


294
00:17:03,357 --> 00:17:05,192 line:-1
<c.magenta>用“照片”应用获取那么多照片</c>


295
00:17:05,759 --> 00:17:08,228 line:-1
<c.magenta>因此今年我们想让它变得非常简单</c>


296
00:17:08,595 --> 00:17:10,564 line:-1
<c.magenta>我们提供了一个示例应用下载</c>


297
00:17:10,631 --> 00:17:12,232 line:-1
<c.magenta>名为Photo Library Filler</c>


298
00:17:13,267 --> 00:17:15,368 line:-1
<c.magenta>下载该应用并安装到你的测试设备</c>


299
00:17:15,669 --> 00:17:19,339 line:-1
<c.magenta>它会迅速生成一个巨大的库供测试使用</c>


300
00:17:21,074 --> 00:17:21,909 line:-1
<c.magenta>很好</c>


301
00:17:26,680 --> 00:17:29,583 line:-2
<c.magenta>很好 一个巨大的库产生了</c>
<c.magenta>测试你的应用</c>


302
00:17:30,050 --> 00:17:31,885 line:-1
<c.magenta>有可能会看到 开始出现延迟</c>


303
00:17:32,653 --> 00:17:34,021 line:-1
<c.magenta>因此我想讲将</c>


304
00:17:34,121 --> 00:17:36,523 line:-1
<c.magenta>客户使用PhotoKit中的两个常见问题</c>


305
00:17:36,590 --> 00:17:37,457 line:-1
<c.magenta>及其解决方法</c>


306
00:17:38,825 --> 00:17:39,960 line:-1
<c.magenta>让我们看一段代码</c>


307
00:17:41,595 --> 00:17:44,364 line:-2
<c.magenta>这是如何从用户的</c>
<c.magenta>Photo Library提取图片</c>


308
00:17:44,431 --> 00:17:45,532 line:-1
<c.magenta>有两个部分</c>


309
00:17:45,699 --> 00:17:48,836 line:-2
<c.magenta>这是提取数据库的部分</c>
<c.magenta>然后是处理结果</c>


310
00:17:49,970 --> 00:17:52,139 line:-1
<c.magenta>首先来看数据库提取部分</c>


311
00:17:53,140 --> 00:17:55,509 line:-1
<c.magenta>在这里 我们提取库里所有资产</c>


312
00:17:55,576 --> 00:17:58,212 line:-1
<c.magenta>但我们用一个筛选器谓词筛选</c>


313
00:17:58,345 --> 00:17:59,379 line:-1
<c.magenta>最喜欢资产</c>


314
00:17:59,613 --> 00:18:01,315 line:-1
<c.magenta>并且按照创建日期排序</c>


315
00:18:02,583 --> 00:18:04,551 line:-1
<c.magenta>如果你进行这一类的自定义提取</c>


316
00:18:04,852 --> 00:18:06,253 line:-1
<c.magenta>应用一定支持</c>


317
00:18:06,553 --> 00:18:09,323 line:-1
<c.magenta>但是如果在这些自定义提取里发现延迟</c>


318
00:18:09,857 --> 00:18:12,926 line:-1
<c.magenta>则简化谓词十分必要</c>


319
00:18:12,993 --> 00:18:14,428 line:-1
<c.magenta>或者简化描述符</c>


320
00:18:14,828 --> 00:18:16,063 line:-1
<c.magenta>会意味着差异产生</c>


321
00:18:16,129 --> 00:18:20,067 line:-1
<c.magenta>查询耗时10毫秒和10秒</c>


322
00:18:20,801 --> 00:18:22,669 line:-1
<c.magenta>造成这种巨大差异的原因</c>


323
00:18:23,270 --> 00:18:26,773 line:-1
<c.magenta>是你可能在数据库优化路径之外</c>


324
00:18:27,174 --> 00:18:29,543 line:-1
<c.magenta>试图回到优化路径中</c>


325
00:18:29,610 --> 00:18:30,511 line:-1
<c.magenta>一定有所回报</c>


326
00:18:32,446 --> 00:18:34,781 line:0
<c.magenta>比这种自定义提取更好的是</c>


327
00:18:34,982 --> 00:18:36,850 line:0
<c.magenta>尽可能避免这种操作</c>


328
00:18:37,384 --> 00:18:40,854 line:0
<c.magenta>因此在这个例子 我们实际上提取</c>
<c.magenta>用户最喜欢的智能相簿</c>


329
00:18:41,054 --> 00:18:43,490 line:0
<c.magenta>然后在智能相簿里提取资产</c>


330
00:18:43,790 --> 00:18:46,727 line:0
<c.magenta>这样既可使用已有的谓词和排序描述符</c>


331
00:18:46,960 --> 00:18:50,797 line:0
<c.magenta>还可以保证留在PhotoKit的优化路径中</c>


332
00:18:53,333 --> 00:18:55,536 line:0
<c.magenta>接下来看一下返回结果</c>


333
00:18:55,602 --> 00:18:56,670 line:-1
<c.magenta>从这些提取之一</c>


334
00:18:57,404 --> 00:19:00,107 line:-1
<c.magenta>这个对象是一个PHFetch结果</c>


335
00:19:00,908 --> 00:19:03,477 line:-1
<c.magenta>该PHFetch结果非常像一个数列</c>


336
00:19:03,644 --> 00:19:05,445 line:-1
<c.magenta>并且可以很像一个数组来使用它</c>


337
00:19:05,712 --> 00:19:08,382 line:-1
<c.magenta>可以要求对象和索引</c>


338
00:19:08,882 --> 00:19:11,351 line:-1
<c.magenta>可以要求计数 并对其进行枚举</c>


339
00:19:11,952 --> 00:19:16,590 line:-2
<c.magenta>但从内部来看 提取结果</c>
<c.magenta>和数列的工作机制完全不同</c>


340
00:19:16,924 --> 00:19:19,359 line:-2
<c.magenta>并且是PhotoKit</c>
<c.magenta>如此快速高效的原因之一</c>


341
00:19:19,526 --> 00:19:20,561 line:-1
<c.magenta>在大型图库操作方面</c>


342
00:19:20,861 --> 00:19:22,462 line:-1
<c.magenta>让我们看看其内部工作机制</c>


343
00:19:24,264 --> 00:19:27,835 line:-1
<c.magenta>最开始它只包含一个标识符列表</c>


344
00:19:28,268 --> 00:19:30,804 line:-1
<c.magenta>这意味可以迅速返回</c>


345
00:19:31,004 --> 00:19:34,141 line:-1
<c.magenta>但开始使用后 更多工作必须执行</c>


346
00:19:35,375 --> 00:19:37,077 line:-1
<c.magenta>让我们看一下枚举作为例子</c>


347
00:19:37,544 --> 00:19:40,347 line:-1
<c.magenta>在这里 我们从索引0开始枚举</c>


348
00:19:41,815 --> 00:19:43,317 line:-1
<c.magenta>目前只有一个标识符</c>


349
00:19:43,383 --> 00:19:45,853 line:-1
<c.magenta>需要从数据库里提取元数据</c>


350
00:19:45,986 --> 00:19:49,756 line:-2
<c.magenta>为了创建一个PHAsset对象</c>
<c.magenta>从块中返回给你</c>


351
00:19:51,024 --> 00:19:52,926 line:-1
<c.magenta>现在 提取结果非常智能</c>


352
00:19:52,993 --> 00:19:55,495 line:-1
<c.magenta>它实际上同时创建了一个批处理</c>


353
00:19:55,829 --> 00:19:59,433 line:-2
<c.magenta>因此 当我们继续枚举时</c>
<c.magenta>索引1和2已经在内存中</c>


354
00:20:00,167 --> 00:20:02,769 line:-1
<c.magenta>然后枚举继续 你们有所了解</c>


355
00:20:03,170 --> 00:20:04,571 line:-1
<c.magenta>它将访问硬盘</c>


356
00:20:04,671 --> 00:20:07,207 line:-1
<c.magenta>获取后续资产的元数据</c>


357
00:20:09,109 --> 00:20:11,578 line:-2
<c.magenta>因此对于这种少量提取结果</c>
<c.magenta>并不受影响</c>


358
00:20:11,812 --> 00:20:15,516 line:-2
<c.magenta>但可以想象该提取结果</c>
<c.magenta>包含10万个资产</c>


359
00:20:17,050 --> 00:20:19,486 line:-1
<c.magenta>每一批都占据几千字节内存</c>


360
00:20:20,087 --> 00:20:21,355 line:-1
<c.magenta>但如果有10万批</c>


361
00:20:21,421 --> 00:20:24,024 line:-1
<c.magenta>将会产生几百兆的内存用量</c>


362
00:20:24,858 --> 00:20:28,962 line:-2
<c.magenta>更糟糕的是</c>
<c.magenta>每一批都需要几毫秒的提取时间</c>


363
00:20:29,196 --> 00:20:30,631 line:-1
<c.magenta>如果有10万批</c>


364
00:20:30,764 --> 00:20:34,201 line:-2
<c.magenta>就需要耗费10秒钟</c>
<c.magenta>来枚举一个大型提取结果</c>


365
00:20:35,169 --> 00:20:38,772 line:0
<c.magenta>所以在任何情况下</c>
<c.magenta>都应该尽量避免枚举操作</c>


366
00:20:40,040 --> 00:20:40,874 line:-1
<c.magenta>我们发现</c>


367
00:20:40,941 --> 00:20:43,911 line:-1
<c.magenta>避免枚举操作总是可能的</c>


368
00:20:44,211 --> 00:20:46,947 line:-1
<c.magenta>我想看一个避免枚举的例子</c>


369
00:20:49,616 --> 00:20:52,819 line:-2
<c.magenta>所以在本例中我们想找到</c>
<c.magenta>一个资产的索引</c>


370
00:20:52,886 --> 00:20:54,188 line:-1
<c.magenta>从一个提取结果中</c>


371
00:20:54,888 --> 00:20:56,490 line:-1
<c.magenta>现在我们可以枚举该提取结果</c>


372
00:20:56,557 --> 00:20:59,626 line:-1
<c.magenta>并且用“等于”比较返回的对象</c>


373
00:20:59,927 --> 00:21:02,129 line:-1
<c.magenta>但是如屏幕所见 枚举非常慢</c>


374
00:21:02,763 --> 00:21:05,699 line:-1
<c.magenta>所以更好的方法其实是使用高端API</c>


375
00:21:05,766 --> 00:21:07,668 line:-1
<c.magenta>本例可以使用indexOfObject</c>


376
00:21:08,235 --> 00:21:11,038 line:-1
<c.magenta>这可以使提取结果内部 变得非常智能</c>


377
00:21:11,338 --> 00:21:15,209 line:-1
<c.magenta>并比较寻找的对象标识符</c>


378
00:21:15,509 --> 00:21:17,311 line:-1
<c.magenta>用一个数组定义所需的索引</c>


379
00:21:17,377 --> 00:21:21,181 line:-1
<c.magenta>完全没有附加的硬盘访问或数据库提取</c>


380
00:21:22,015 --> 00:21:23,817 line:-1
<c.magenta>对containsObject也是如此</c>


381
00:21:25,819 --> 00:21:27,721 line:-1
<c.magenta>所以希望你们了解这有多么简单</c>


382
00:21:27,788 --> 00:21:30,290 line:-1
<c.magenta>用一个庞大的库测试你的应用</c>


383
00:21:30,490 --> 00:21:31,425 line:-1
<c.magenta>以及有多么简单</c>


384
00:21:31,491 --> 00:21:34,795 line:-1
<c.magenta>去真正改进应用的性能表现</c>


385
00:21:35,362 --> 00:21:38,732 line:-1
<c.magenta>微小的修正可能意味着节省几秒钟</c>


386
00:21:40,434 --> 00:21:42,669 line:-1
<c.magenta>如果有关于PhotoKit性能的问题</c>


387
00:21:42,736 --> 00:21:44,571 line:-1
<c.magenta>明天早上请到实验室来找我们</c>


388
00:21:44,738 --> 00:21:47,441 line:-1
<c.magenta>如果你遇到了无法解决的问题</c>


389
00:21:47,674 --> 00:21:48,675 line:-1
<c.magenta>请 [听不清]</c>


390
00:21:49,543 --> 00:21:51,945 line:-1
<c.magenta>如果本场演讲只需记住一点</c>


391
00:21:52,346 --> 00:21:54,915 line:-2
<c.magenta>那就是请用大型</c>
<c.magenta>Photo Library测试你的应用</c>


392
00:21:55,048 --> 00:21:57,918 line:-1
<c.magenta>并认真照顾那些重要客户的需求</c>


393
00:21:59,686 --> 00:22:02,256 line:-1
<c.magenta>接下来 我想欢迎Eric Hanson回到讲台</c>


394
00:22:02,556 --> 00:22:04,224 line:-1
<c.magenta>讲解照片项目扩展</c>


395
00:22:04,925 --> 00:22:07,694 line:-2
<c.magenta>-Eric</c>
<c.magenta>-谢谢你 Andreas</c>


396
00:22:09,429 --> 00:22:10,264 line:-1
<c.magenta>谢谢</c>


397
00:22:10,330 --> 00:22:14,535 line:-1
<c.magenta>我非常 非常激动 终于可以来讲讲</c>


398
00:22:14,601 --> 00:22:17,838 line:-2
<c.magenta>今年我们在High Sierra</c>
<c.magenta>一直努力工作的成果</c>


399
00:22:17,971 --> 00:22:20,207 line:-1
<c.magenta>我现在非常需要喝口水 抱歉</c>


400
00:22:22,743 --> 00:22:23,577 line:-1
<c.magenta>好了</c>


401
00:22:25,078 --> 00:22:28,148 line:-1
<c.magenta>所以我们来讲讲照片项目扩展</c>


402
00:22:28,415 --> 00:22:31,985 line:-2
<c.magenta>我觉得要开始讲这个主题</c>
<c.magenta>必须要先讲什么是项目</c>


403
00:22:32,819 --> 00:22:35,289 line:-1
<c.magenta>你们知道Apple一直允许用户</c>


404
00:22:35,355 --> 00:22:40,661 line:-2
<c.magenta>创建非常丰富的</c>
<c.magenta>有创意的围绕照片展开的项目</c>


405
00:22:40,727 --> 00:22:43,397 line:-1
<c.magenta>很长时间以来在“照片”应用</c>


406
00:22:43,463 --> 00:22:46,066 line:-2
<c.magenta>实际上 这可以追溯到很久以前的</c>
<c.magenta>iPhoto 1.0</c>


407
00:22:46,133 --> 00:22:48,402 line:-1
<c.magenta>当我们第一次发布photobooks时</c>


408
00:22:50,304 --> 00:22:52,339 line:-1
<c.magenta>但是今年 我们想要些不同的东西</c>


409
00:22:52,739 --> 00:22:56,343 line:-1
<c.magenta>因为这么长时间以来 14年</c>


410
00:22:56,944 --> 00:22:58,045 line:-1
<c.magenta>作为开发者的你们</c>


411
00:22:58,111 --> 00:23:01,748 line:-1
<c.magenta>已经积累了非常宝贵的经验</c>


412
00:23:01,915 --> 00:23:03,050 line:-1
<c.magenta>在自己开发的应用中</c>


413
00:23:03,851 --> 00:23:06,520 line:-2
<c.magenta>我们认为 你们知道</c>
<c.magenta>让我们一起合作</c>


414
00:23:06,720 --> 00:23:09,890 line:-2
<c.magenta>让我们给你们一个机会</c>
<c.magenta>真正创造一些东西</c>


415
00:23:10,090 --> 00:23:13,760 line:-1
<c.magenta>直接在“照片”应用中的美好的体验</c>


416
00:23:14,361 --> 00:23:16,663 line:-1
<c.magenta>这正是我们在扩展方面的成果</c>


417
00:23:17,965 --> 00:23:22,035 line:-2
<c.magenta>我们从API着手</c>
<c.magenta>只有几个开发者参与其中</c>


418
00:23:22,102 --> 00:23:23,437 line:-1
<c.magenta>看看他们会做出什么</c>


419
00:23:23,504 --> 00:23:25,072 line:-1
<c.magenta>如Shutterfly这样的公司</c>


420
00:23:25,439 --> 00:23:27,374 line:-1
<c.magenta>将会在秋天启动自己的照片集</c>


421
00:23:27,441 --> 00:23:28,675 line:-1
<c.magenta>和照片应用</c>


422
00:23:29,810 --> 00:23:30,944 line:-1
<c.magenta>一家名为WhiteWall的公司</c>


423
00:23:31,011 --> 00:23:34,214 line:-2
<c.magenta>将会允许你制作这些</c>
<c.magenta>拥有画廊品质的表框印刷品</c>


424
00:23:36,116 --> 00:23:39,286 line:-1
<c.magenta>Wix.com将会开发全新的功能</c>


425
00:23:39,353 --> 00:23:42,422 line:-1
<c.magenta>让用户方便地创建网络相簿</c>


426
00:23:44,124 --> 00:23:48,595 line:-2
<c.magenta>Animoto公司允许用户创建</c>
<c.magenta>这些非常漂亮的影片</c>


427
00:23:48,662 --> 00:23:51,498 line:-1
<c.magenta>由服务器托管并和社交媒体集成</c>


428
00:23:52,833 --> 00:23:57,938 line:-2
<c.magenta>还有一家名为ifolor的公司</c>
<c.magenta>做出了非常新颖的创新</c>


429
00:23:58,438 --> 00:24:01,775 line:-1
<c.magenta>他们几乎是白手起家</c>


430
00:24:02,242 --> 00:24:04,411 line:-1
<c.magenta>把这看作一个机会</c>


431
00:24:04,811 --> 00:24:08,415 line:-2
<c.magenta>你知道 他们做出一样产品</c>
<c.magenta>能够真正融入到照片的生态系统</c>


432
00:24:08,482 --> 00:24:10,717 line:-1
<c.magenta>并为用户真正创造某种魔法</c>


433
00:24:11,084 --> 00:24:13,053 line:-1
<c.magenta>我觉得与其口头描述</c>


434
00:24:13,253 --> 00:24:14,721 line:-1
<c.magenta>不如给你们放一段快速演示</c>


435
00:24:14,988 --> 00:24:18,058 line:-2
<c.magenta>我们在这里</c>
<c.magenta>High Sierra的“照片”应用</c>


436
00:24:18,659 --> 00:24:19,927 line:-1
<c.magenta>我在“回忆”里</c>


437
00:24:19,993 --> 00:24:23,697 line:-2
<c.magenta>在这里有我最喜欢的回忆</c>
<c.magenta>我会在其中选择</c>


438
00:24:24,398 --> 00:24:28,101 line:-1
<c.magenta>在侧栏 我可以将鼠标悬停在项目区域</c>


439
00:24:28,168 --> 00:24:29,670 line:-1
<c.magenta>可以看到这个小按钮</c>


440
00:24:30,137 --> 00:24:33,674 line:-1
<c.magenta>你会注意到 除了Apple现有提供的功能</c>


441
00:24:34,508 --> 00:24:36,143 line:-1
<c.magenta>照片应用自动发现</c>


442
00:24:36,210 --> 00:24:38,111 line:-1
<c.magenta>我还安装了另一款应用</c>


443
00:24:39,847 --> 00:24:41,448 line:-1
<c.magenta>名为ifolor wall décor</c>


444
00:24:41,682 --> 00:24:43,750 line:-1
<c.magenta>因此 这个扩展完全显示给我</c>


445
00:24:44,918 --> 00:24:48,689 line:-1
<c.magenta>选中它 然后我面临着几个选项</c>


446
00:24:48,889 --> 00:24:52,192 line:-1
<c.magenta>这些选项都是从扩展本身延伸出来</c>


447
00:24:52,759 --> 00:24:54,561 line:-1
<c.magenta>因此 甚至在加载该扩展之前</c>


448
00:24:54,628 --> 00:24:56,997 line:-1
<c.magenta>扩展通知我们说 你知道</c>


449
00:24:57,064 --> 00:25:01,301 line:-2
<c.magenta>在你推送一个项目之前</c>
<c.magenta>我想要用户做出选择</c>


450
00:25:01,368 --> 00:25:03,537 line:-1
<c.magenta>我想要分叉自己的代码</c>


451
00:25:04,204 --> 00:25:07,007 line:-1
<c.magenta>因此 它给了我们标题 描述和图片</c>


452
00:25:07,174 --> 00:25:09,576 line:-1
<c.magenta>照片应用在表格里将它摆放得非常漂亮</c>


453
00:25:10,344 --> 00:25:12,346 line:-1
<c.magenta>现在我选择第一个选项</c>


454
00:25:13,847 --> 00:25:14,848 line:-1
<c.magenta>点击“创建”按钮</c>


455
00:25:16,149 --> 00:25:18,051 line:-1
<c.magenta>现在 它们的扩展</c>


456
00:25:18,452 --> 00:25:21,288 line:-2
<c.magenta>它们的视图控制器将会直接</c>
<c.magenta>b>推送至照片应用</c>


457
00:25:21,555 --> 00:25:26,426 line:-2
<c.magenta>全景视图 但这是它们的UI</c>
<c.magenta>这是它们在“照片”中的体验</c>


458
00:25:27,261 --> 00:25:29,763 line:-1
<c.magenta>现在 本例中它们利用了内存</c>


459
00:25:30,030 --> 00:25:33,367 line:-1
<c.magenta>并采纳了我们提供的提示来布局该网格</c>


460
00:25:34,635 --> 00:25:37,538 line:-1
<c.magenta>但是他们还采纳了我们提供的提示</c>


461
00:25:38,205 --> 00:25:40,474 line:-1
<c.magenta>让我能够提取所有的图片</c>


462
00:25:40,541 --> 00:25:42,609 line:-1
<c.magenta>在内存被创建时就被考虑的</c>


463
00:25:42,910 --> 00:25:45,112 line:-1
<c.magenta>因此 在这里会注意到 在右下角</c>


464
00:25:45,179 --> 00:25:49,149 line:-2
<c.magenta>如果你可以看见它 你看不见</c>
<c.magenta>因为它在我后面 283张图片</c>


465
00:25:50,484 --> 00:25:53,220 line:-2
<c.magenta>关于这点非常酷的一点是</c>
<c.magenta>我可以自定义</c>


466
00:25:53,287 --> 00:25:55,656 line:-1
<c.magenta>现在我会将其切换到未使用图片</c>


467
00:25:56,256 --> 00:25:59,526 line:-1
<c.magenta>因为我想选择一张更喜欢一点的照片</c>


468
00:26:02,296 --> 00:26:05,499 line:-2
<c.magenta>我选择这张 我认为它将成为</c>
<c.magenta>非常伟大的杰作</c>


469
00:26:05,866 --> 00:26:08,168 line:-2
<c.magenta>我将它拖上去</c>
<c.magenta>然后定义该布局</c>


470
00:26:10,137 --> 00:26:11,705 line:-1
<c.magenta>然后他们更进了一步</c>


471
00:26:11,772 --> 00:26:16,009 line:-2
<c.magenta>他们让我自定义网格本身</c>
<c.magenta>以一种非常新颖的方式</c>


472
00:26:16,176 --> 00:26:18,779 line:-1
<c.magenta>我想要特别强调一下这一行</c>


473
00:26:19,446 --> 00:26:20,714 line:-1
<c.magenta>这张也许可以往下移动一些</c>


474
00:26:21,682 --> 00:26:23,450 line:-1
<c.magenta>把这张也往下移一些对齐</c>


475
00:26:24,985 --> 00:26:26,920 line:-1
<c.magenta>再做一些调整</c>


476
00:26:27,955 --> 00:26:29,156 line:-1
<c.magenta>我很喜欢</c>


477
00:26:29,590 --> 00:26:32,526 line:-2
<c.magenta>所以我可以点击“购买”按钮</c>
<c.magenta>还在照片里面</c>


478
00:26:33,827 --> 00:26:35,896 line:-1
<c.magenta>选择尺寸 将会在信箱里收到</c>


479
00:26:35,963 --> 00:26:38,098 line:-2
<c.magenta>然后我就可以把这份回忆</c>
<c.magenta>挂在客厅的墙上了</c>


480
00:26:38,498 --> 00:26:39,333 line:-1
<c.magenta>非常酷</c>


481
00:26:39,399 --> 00:26:42,669 line:-1
<c.magenta>这是关于ifolor非常快速的演示</c>


482
00:26:49,376 --> 00:26:52,412 line:-2
<c.magenta>所以 你们想知道的是</c>
<c.magenta>这些功能是如何实现的</c>


483
00:26:55,482 --> 00:26:59,119 line:-2
<c.magenta>如果你熟悉在照片应用里的</c>
<c.magenta>编辑扩展功能</c>


484
00:26:59,720 --> 00:27:03,357 line:-1
<c.magenta>那你已经对其工作原理有很好的感觉</c>


485
00:27:04,625 --> 00:27:08,262 line:-1
<c.magenta>我们在照片中添加了一个新的扩展点</c>


486
00:27:08,495 --> 00:27:10,964 line:-1
<c.magenta>com.apple.photo-project</c>


487
00:27:12,466 --> 00:27:15,135 line:-1
<c.magenta>我们还在Xcode中添加了一个新模板</c>


488
00:27:15,936 --> 00:27:19,373 line:-2
<c.magenta>这将让你在自己的应用里</c>
<c.magenta>轻松创建这些扩展</c>


489
00:27:20,240 --> 00:27:22,176 line:-1
<c.magenta>如演示所示</c>


490
00:27:22,643 --> 00:27:25,078 line:-1
<c.magenta>我们自动发现你的扩展</c>


491
00:27:25,312 --> 00:27:28,248 line:-1
<c.magenta>提高应用在系统的可发现性</c>


492
00:27:28,749 --> 00:27:31,351 line:-1
<c.magenta>但是我们让该可发现性更进一步</c>


493
00:27:32,519 --> 00:27:35,856 line:-1
<c.magenta>通过为用户提供App Store的直接链接</c>


494
00:27:36,523 --> 00:27:39,193 line:-1
<c.magenta>该链接会打开App Store窗口</c>


495
00:27:39,593 --> 00:27:43,664 line:-1
<c.magenta>但并不要求用户搜索具有该扩展的应用</c>


496
00:27:43,931 --> 00:27:47,734 line:-1
<c.magenta>将会自动只显示支持该扩展点的应用</c>


497
00:27:48,302 --> 00:27:50,737 line:-1
<c.magenta>我们认为这将大大提高</c>


498
00:27:51,205 --> 00:27:53,707 line:-1
<c.magenta>用户发现你的应用的能力</c>


499
00:27:53,774 --> 00:27:55,976 line:-1
<c.magenta>并能快速下载并使用它们</c>


500
00:27:56,743 --> 00:27:57,578 line:-1
<c.magenta>我们非常确信这点</c>


501
00:27:57,644 --> 00:28:00,347 line:-2
<c.magenta>所以我们在“编辑”中</c>
<c.magenta>加入了类似的App Store链接</c>


502
00:28:01,081 --> 00:28:04,751 line:-1
<c.magenta>所以 如果你已经在进行图片编辑扩展</c>


503
00:28:05,152 --> 00:28:07,187 line:-2
<c.magenta>用户将会得到通往</c>
<c.magenta>App Store的直接链接</c>


504
00:28:07,254 --> 00:28:10,224 line:-1
<c.magenta>去直接发现你的编辑扩展</c>


505
00:28:11,191 --> 00:28:12,025 line:-1
<c.magenta>这非常酷</c>


506
00:28:16,697 --> 00:28:21,702 line:-2
<c.magenta>所以你的扩展只存在于你的应用内</c>
<c.magenta>在你的应用内</c>


507
00:28:22,936 --> 00:28:24,738 line:-1
<c.magenta>对你们来说是一个很棒的机会</c>


508
00:28:24,805 --> 00:28:26,907 line:-2
<c.magenta>因为你也许已经在</c>
<c.magenta>App Store有了一个应用</c>


509
00:28:27,174 --> 00:28:28,976 line:-1
<c.magenta>已经有了许多应用特定代码</c>


510
00:28:29,042 --> 00:28:32,880 line:-2
<c.magenta>但也许你有一些资源</c>
<c.magenta>以及其他一些可共享代码</c>


511
00:28:32,946 --> 00:28:34,248 line:0
<c.magenta>你可以很容易地移动到</c>


512
00:28:34,314 --> 00:28:36,884 line:0
<c.magenta>该扩展空间内 并加以利用</c>


513
00:28:37,985 --> 00:28:42,222 line:0
<c.magenta>显然你也有一些扩展特定代码</c>


514
00:28:42,289 --> 00:28:43,223 line:0
<c.magenta>你可能需要写下的</c>


515
00:28:43,323 --> 00:28:44,424 line:0
<c.magenta>很少一部分</c>


516
00:28:44,958 --> 00:28:47,761 line:0
<c.magenta>最后 你只需要添加一个视图控制器</c>


517
00:28:48,161 --> 00:28:50,264 line:0
<c.magenta>实现该协议</c>


518
00:28:50,330 --> 00:28:53,066 line:0
<c.magenta>PHprojectextensioncontroller协议</c>


519
00:28:53,901 --> 00:28:55,135 line:0
<c.magenta>随着所有一切就位</c>


520
00:28:56,136 --> 00:28:59,806 line:0
<c.magenta>照片应用可以立即发现你的扩展</c>


521
00:29:00,641 --> 00:29:04,311 line:0
<c.magenta>让用户选择 你知道</c>
<c.magenta>用它创建一个项目</c>


522
00:29:05,112 --> 00:29:08,549 line:0
<c.magenta>我们简单称该协议为</c>
<c.magenta>方法开始项目</c>


523
00:29:09,583 --> 00:29:15,022 line:0
<c.magenta>我们这样做时 会发送一些字节数据</c>


524
00:29:15,789 --> 00:29:16,890 line:0
<c.magenta>除了照片以外</c>


525
00:29:16,957 --> 00:29:19,626 line:0
<c.magenta>我们还发送项目扩展上下文</c>


526
00:29:19,927 --> 00:29:23,130 line:0
<c.magenta>还发送一个名为PHProjectInfo的对象</c>


527
00:29:24,031 --> 00:29:26,133 line:0
<c.magenta>可以用任何想要的方式使用它</c>


528
00:29:27,167 --> 00:29:31,638 line:0
<c.magenta>然后只需迅速返回</c>
<c.magenta>我们发给你的完成结束</c>


529
00:29:32,206 --> 00:29:35,342 line:0
<c.magenta>并让照片知道</c>
<c.magenta>可以安装你的视图控制器</c>


530
00:29:35,576 --> 00:29:37,778 line:0
<c.magenta>照片应用里的全景视图</c>


531
00:29:38,045 --> 00:29:41,682 line:0
<c.magenta>从那点起 如你所见</c>
<c.magenta>它完全成了你的UI</c>


532
00:29:41,748 --> 00:29:43,250 line:-1
<c.magenta>它是你的体验</c>


533
00:29:43,650 --> 00:29:49,056 line:-1
<c.magenta>你拥有所有在macOS上可用的API</c>


534
00:29:49,656 --> 00:29:53,594 line:-2
<c.magenta>可以利用并可以为用户</c>
<c.magenta>构建出很棒的体验</c>


535
00:29:56,797 --> 00:29:59,032 line:-1
<c.magenta>所以 协议本身非常简单</c>


536
00:29:59,600 --> 00:30:03,303 line:-1
<c.magenta>对支持的项目类型还有一个可选属性</c>


537
00:30:03,537 --> 00:30:05,472 line:-1
<c.magenta>你已经在刚才我的演示中看到</c>


538
00:30:05,906 --> 00:30:07,908 line:-1
<c.magenta>这将让你快速描述选项</c>


539
00:30:07,975 --> 00:30:09,109 line:-1
<c.magenta>你想让用户选择的</c>


540
00:30:09,676 --> 00:30:11,178 line:-1
<c.magenta>如果你想 也可以选择退出</c>


541
00:30:11,245 --> 00:30:12,713 line:-1
<c.magenta>如果你只想直接进入扩展</c>


542
00:30:12,779 --> 00:30:14,481 line:-1
<c.magenta>这也是完全可能的</c>


543
00:30:15,449 --> 00:30:17,417 line:-1
<c.magenta>这就需要一些必需的函数</c>


544
00:30:17,484 --> 00:30:19,419 line:-1
<c.magenta>需要在视图控制器里实现</c>


545
00:30:20,220 --> 00:30:21,788 line:-1
<c.magenta>第一个是beginProject</c>


546
00:30:22,689 --> 00:30:25,492 line:-2
<c.magenta>在这里我们传给你上下文</c>
<c.magenta>以及项目信息</c>


547
00:30:26,560 --> 00:30:32,399 line:-2
<c.magenta>这杯我们称为第一次</c>
<c.magenta>一个用你的扩展创建的项目</c>


548
00:30:33,200 --> 00:30:36,103 line:-1
<c.magenta>现在 如果用户回到你的扩展</c>


549
00:30:36,170 --> 00:30:37,938 line:0
<c.magenta>为了已经创建的项目</c>


550
00:30:38,105 --> 00:30:40,307 line:0
<c.magenta>我们则调用resumeProject函数</c>


551
00:30:40,707 --> 00:30:43,277 line:0
<c.magenta>并再一次发送</c>
<c.magenta>给你该扩展上下文</c>


552
00:30:45,812 --> 00:30:49,616 line:0
<c.magenta>最后 如果用户在你的扩展内</c>


553
00:30:49,850 --> 00:30:52,986 line:0
<c.magenta>他们决定切换离开</c>
<c.magenta>在照片里做别的事情</c>


554
00:30:53,187 --> 00:30:54,821 line:0
<c.magenta>我们只需调用finishProject函数</c>


555
00:30:54,888 --> 00:30:58,158 line:0
<c.magenta>允许你清理任何正在处理的数据</c>


556
00:30:58,225 --> 00:31:01,562 line:0
<c.magenta>也许关闭任何让处理器忙碌的任务</c>


557
00:31:01,628 --> 00:31:03,630 line:0
<c.magenta>或动画之类你正在处理的数据</c>


558
00:31:08,402 --> 00:31:10,604 line:-1
<c.magenta>PHProjectExtensionContext</c>


559
00:31:11,238 --> 00:31:14,074 line:-1
<c.magenta>是个包含两个非常重要的对象的容器</c>


560
00:31:14,141 --> 00:31:18,946 line:-2
<c.magenta>一个是PHProject</c>
<c.magenta>另一个是PHPhotoLibrary</c>


561
00:31:19,446 --> 00:31:23,483 line:0
<c.magenta>也就是你将提取所有资产的库</c>


562
00:31:27,154 --> 00:31:28,789 line:0
<c.magenta>PHProject本身</c>


563
00:31:30,557 --> 00:31:34,394 line:0
<c.magenta>只是PHAsset的一个子集</c>


564
00:31:34,728 --> 00:31:38,198 line:0
<c.magenta>也许你已经对</c>
<c.magenta>PHAssetCollection很熟悉</c>


565
00:31:40,701 --> 00:31:41,602 line:0
<c.magenta>它是个容器</c>


566
00:31:41,702 --> 00:31:43,937 line:0
<c.magenta>它有一个资产数列</c>


567
00:31:44,338 --> 00:31:45,272 line:0
<c.magenta>还有一个名字</c>


568
00:31:45,472 --> 00:31:47,307 line:0
<c.magenta>还有一个关键资产 关键照片</c>


569
00:31:47,841 --> 00:31:49,877 line:0
<c.magenta>我们在子集中所做的</c>


570
00:31:49,943 --> 00:31:52,813 line:0
<c.magenta>创建PHProject</c>
<c.magenta>就是我们只添加了一个属性</c>


571
00:31:53,647 --> 00:31:56,216 line:0
<c.magenta>但是它是一个对你来说非常</c>
<c.magenta>非常重要的属性</c>


572
00:31:56,450 --> 00:31:58,352 line:0
<c.magenta>就是projectExtensionData</c>


573
00:31:58,952 --> 00:32:01,054 line:0
<c.magenta>所以 这就是你 扩展</c>


574
00:32:01,121 --> 00:32:03,524 line:0
<c.magenta>可以保存任何你需要的数据</c>


575
00:32:03,690 --> 00:32:05,926 line:-1
<c.magenta>可以代表用户创建的项目</c>


576
00:32:06,360 --> 00:32:09,496 line:-1
<c.magenta>所以 它是为了重要的项目数据</c>


577
00:32:09,563 --> 00:32:13,667 line:-1
<c.magenta>它是你正在使用的资产标识符的列表</c>


578
00:32:13,734 --> 00:32:16,670 line:-1
<c.magenta>也许是一些基本的布局信息</c>


579
00:32:16,737 --> 00:32:18,138 line:-1
<c.magenta>配置信息</c>


580
00:32:18,605 --> 00:32:22,509 line:-2
<c.magenta>并不是为了图片 以及</c>
<c.magenta>你知道 缓存</c>


581
00:32:22,576 --> 00:32:24,311 line:-1
<c.magenta>缩略图 花名册 诸如此类</c>


582
00:32:24,378 --> 00:32:27,548 line:-2
<c.magenta>因为你可以快速创建它们</c>
<c.magenta>或把它们缓存到其他位置</c>


583
00:32:29,116 --> 00:32:33,187 line:-1
<c.magenta>所以我们需要它小而有用</c>


584
00:32:33,554 --> 00:32:36,023 line:-1
<c.magenta>我们把这个限制定为1兆</c>


585
00:32:36,590 --> 00:32:37,758 line:-1
<c.magenta>因为我们认为 你知道</c>


586
00:32:38,325 --> 00:32:41,361 line:-2
<c.magenta>压缩资产标识符数组</c>
<c.magenta>非常非常简单</c>


587
00:32:41,428 --> 00:32:42,829 line:-1
<c.magenta>它们都只不过是字符串</c>


588
00:32:43,263 --> 00:32:45,265 line:-1
<c.magenta>我们认为 1兆大小已经足够</c>


589
00:32:45,332 --> 00:32:48,702 line:-1
<c.magenta>而这么做 我们不会增大用户的库</c>


590
00:32:48,769 --> 00:32:50,637 line:-1
<c.magenta>当用户们不断创建项目</c>


591
00:32:50,737 --> 00:32:53,607 line:-2
<c.magenta>并探寻所有这些优秀的扩展</c>
<c.magenta>那些你将要创建的扩展</c>


592
00:32:57,110 --> 00:32:59,246 line:-1
<c.magenta>所以 设置数据 非常简单</c>


593
00:33:00,113 --> 00:33:02,616 line:-2
<c.magenta>有一个对象名为</c>
<c.magenta>PHProjectChangeRequest</c>


594
00:33:03,116 --> 00:33:06,220 line:-1
<c.magenta>只需将其实例化 实例化以后</c>


595
00:33:06,286 --> 00:33:11,391 line:0
<c.magenta>可以在Photo Library调用</c>
<c.magenta>performChangesAndWait函数</c>


596
00:33:11,758 --> 00:33:14,261 line:0
<c.magenta>在里面将数据设置成任何你想要的形式</c>


597
00:33:14,328 --> 00:33:19,066 line:0
<c.magenta>本例我会用</c>
<c.magenta>NSKeyedArchiver.archivedData</c>


598
00:33:19,233 --> 00:33:21,201 line:0
<c.magenta>一个标识符数组</c>


599
00:33:21,869 --> 00:33:23,337 line:0
<c.magenta>就是这样 非常简单</c>


600
00:33:26,340 --> 00:33:28,008 line:-1
<c.magenta>让我们来看有趣的东西</c>


601
00:33:29,109 --> 00:33:31,411 line:-1
<c.magenta>我想讲讲魔法从哪里开始</c>


602
00:33:33,380 --> 00:33:35,415 line:-1
<c.magenta>所以 你们在ifolor演示中看到</c>


603
00:33:35,482 --> 00:33:38,919 line:-1
<c.magenta>他们完全利用了“回忆”功能</c>


604
00:33:39,052 --> 00:33:42,389 line:-1
<c.magenta>“回忆”功能非常受欢迎</c>


605
00:33:42,990 --> 00:33:44,725 line:-1
<c.magenta>用户很爱这些功能</c>


606
00:33:45,192 --> 00:33:49,596 line:-2
<c.magenta>是的 当你睡觉时</c>
<c.magenta>“照片”整夜都还在工作</c>


607
00:33:50,330 --> 00:33:56,136 line:-2
<c.magenta>遍历你的Photo Library</c>
<c.magenta>似乎正在学着了解你 对吧</c>


608
00:33:56,336 --> 00:33:58,872 line:-2
<c.magenta>在你的设备上</c>
<c.magenta>一切都在本地发生</c>


609
00:33:59,006 --> 00:34:03,710 line:-2
<c.magenta>并且它建立一个图形</c>
<c.magenta>那些对你来说意义重大的事件</c>


610
00:34:03,777 --> 00:34:06,246 line:-1
<c.magenta>生命中和你相关的人</c>


611
00:34:06,580 --> 00:34:11,385 line:-1
<c.magenta>通过这些 它可以产生这些美好的回忆</c>


612
00:34:11,451 --> 00:34:14,288 line:-1
<c.magenta>每天用户都在消费</c>


613
00:34:14,855 --> 00:34:17,024 line:-1
<c.magenta>我们想要确保你可以访问</c>


614
00:34:17,090 --> 00:34:19,760 line:-1
<c.magenta>那一层数据 对吗</c>


615
00:34:19,826 --> 00:34:23,664 line:-2
<c.magenta>如果只给你一组照片</c>
<c.magenta>这些扩展不会那么有趣</c>


616
00:34:23,964 --> 00:34:27,067 line:-2
<c.magenta>我们得给你上下文</c>
<c.magenta>这样你才可以从中有所创新</c>


617
00:34:27,668 --> 00:34:30,670 line:-1
<c.magenta>这就是我们对PHProjectInfo做的</c>


618
00:34:32,371 --> 00:34:36,476 line:-1
<c.magenta>所以 最高层的ProductInfo分成几个区</c>


619
00:34:36,743 --> 00:34:40,447 line:-2
<c.magenta>我们提供这个</c>
<c.magenta>PHProjectSection对象数组</c>


620
00:34:42,382 --> 00:34:45,052 line:-1
<c.magenta>对于某个区 我们告诉你类型</c>


621
00:34:45,219 --> 00:34:49,556 line:-2
<c.magenta>所以你想到一个回忆</c>
<c.magenta>我们在最上层得到一张关键照片</c>


622
00:34:50,023 --> 00:34:51,891 line:-1
<c.magenta>我们把这个类型称为“封面”</c>


623
00:34:52,159 --> 00:34:56,964 line:-2
<c.magenta>然后我们得到该编辑网格</c>
<c.magenta>我们称该类型为“内容”</c>


624
00:34:58,298 --> 00:35:00,834 line:-1
<c.magenta>然后我们给你该内容数组</c>


625
00:35:03,737 --> 00:35:05,038 line:0
<c.magenta>看上去像这个样子</c>


626
00:35:05,105 --> 00:35:06,206 line:0
<c.magenta>在内容里</c>


627
00:35:06,273 --> 00:35:08,075 line:0
<c.magenta>我们会让你可以访问元素</c>


628
00:35:08,141 --> 00:35:10,911 line:0
<c.magenta>资产、标识符和一些布局信息</c>


629
00:35:11,712 --> 00:35:13,981 line:0
<c.magenta>当你看这个构造时 可能会问自己</c>


630
00:35:14,047 --> 00:35:16,316 line:0
<c.magenta>为什么数组里面还有数组</c>


631
00:35:16,383 --> 00:35:18,418 line:0
<c.magenta>为什么是这种嵌套结构</c>


632
00:35:19,386 --> 00:35:24,057 line:-2
<c.magenta>但是如果想想“回忆”的功能</c>
<c.magenta>会发现是有道理的 对吧</c>


633
00:35:24,124 --> 00:35:28,762 line:-2
<c.magenta>我们允许用户和回忆可以</c>
<c.magenta>在显示照片摘要</c>


634
00:35:28,829 --> 00:35:30,297 line:-1
<c.magenta>和显示所有照片之间切换</c>


635
00:35:30,430 --> 00:35:34,801 line:-1
<c.magenta>回忆本身建立于大量资产之上</c>


636
00:35:36,637 --> 00:35:38,539 line:-1
<c.magenta>我们称之为管护层</c>


637
00:35:39,039 --> 00:35:40,908 line:-1
<c.magenta>我们想要确保你可以访问</c>


638
00:35:40,974 --> 00:35:43,410 line:-1
<c.magenta>这些不同层的信息 对吧</c>


639
00:35:43,477 --> 00:35:46,980 line:-2
<c.magenta>我们已经努力做了这么多</c>
<c.magenta>我们完成各种智能操作</c>


640
00:35:47,247 --> 00:35:50,184 line:-2
<c.magenta>让我和你们分享</c>
<c.magenta>希望你们在此之上继续开发</c>


641
00:35:50,884 --> 00:35:54,955 line:-1
<c.magenta>那个sectionContent数组是已排序数组</c>


642
00:35:55,322 --> 00:35:59,760 line:-1
<c.magenta>你会知道索引0的对象总是最好的</c>


643
00:35:59,826 --> 00:36:01,161 line:-1
<c.magenta>是最优的</c>


644
00:36:01,361 --> 00:36:05,966 line:-1
<c.magenta>是资产集合最精炼的摘要</c>


645
00:36:06,600 --> 00:36:09,069 line:-1
<c.magenta>而在数组末端的对象</c>


646
00:36:09,136 --> 00:36:10,003 line:-1
<c.magenta>是最多的</c>


647
00:36:10,070 --> 00:36:11,705 line:-1
<c.magenta>是我们能想到的一切</c>


648
00:36:11,839 --> 00:36:14,007 line:-1
<c.magenta>你可以选择想要使用什么</c>


649
00:36:14,608 --> 00:36:17,477 line:-1
<c.magenta>最少的 最多的 中间所有的</c>


650
00:36:17,845 --> 00:36:20,447 line:-1
<c.magenta>也许你想给用户一个选项</c>


651
00:36:20,514 --> 00:36:22,482 line:-1
<c.magenta>你想让他们可以在其中切换</c>


652
00:36:22,749 --> 00:36:24,985 line:-2
<c.magenta>你可以做到</c>
<c.magenta>用我们在这提供的上下文</c>


653
00:36:29,389 --> 00:36:32,359 line:-1
<c.magenta>接下来 云资产标识符</c>


654
00:36:32,993 --> 00:36:34,328 line:-1
<c.magenta>这是一个较新的概念</c>


655
00:36:34,394 --> 00:36:37,264 line:-1
<c.magenta>如果你对iOS的PhotoKit比较熟悉</c>


656
00:36:37,464 --> 00:36:40,501 line:-1
<c.magenta>你从未见过这个 因为是全新的</c>


657
00:36:41,668 --> 00:36:44,671 line:-1
<c.magenta>但是 我们从未使用过构造</c>


658
00:36:44,738 --> 00:36:48,308 line:-2
<c.magenta>当我们想把数据</c>
<c.magenta>存到用户的Photo Library时</c>


659
00:36:48,375 --> 00:36:50,978 line:-1
<c.magenta>数据代表资产</c>


660
00:36:51,044 --> 00:36:53,213 line:-1
<c.magenta>但数据可能会被同步到其他设备</c>


661
00:36:53,280 --> 00:36:55,782 line:-1
<c.magenta>可能某个时刻出现在别的地方</c>


662
00:36:56,183 --> 00:36:58,719 line:-1
<c.magenta>我们想要确保你在保存的数据</c>


663
00:36:59,386 --> 00:37:01,488 line:-1
<c.magenta>在任何出现的地方都有意义</c>


664
00:37:01,855 --> 00:37:05,158 line:0
<c.magenta>所以 我们推出了一个新对象</c>
<c.magenta>名为PHCloudIdentifier</c>


665
00:37:06,527 --> 00:37:09,997 line:0
<c.magenta>你可以将它看做资产的全局标识符</c>


666
00:37:10,931 --> 00:37:14,468 line:0
<c.magenta>但并不像全局字符串那么简单</c>


667
00:37:15,035 --> 00:37:17,437 line:0
<c.magenta>你知道 处理云和同步状态等</c>


668
00:37:17,504 --> 00:37:19,106 line:0
<c.magenta>是非常非常复杂的</c>


669
00:37:19,373 --> 00:37:21,241 line:0
<c.magenta>我们都已经为你解决好了</c>


670
00:37:22,876 --> 00:37:24,845 line:0
<c.magenta>你必须要做的唯一操作</c>


671
00:37:25,279 --> 00:37:28,415 line:0
<c.magenta>是确保你的转换总是从全局标识符</c>


672
00:37:28,482 --> 00:37:31,051 line:0
<c.magenta>到本地标识符 在提取之前</c>


673
00:37:31,251 --> 00:37:32,686 line:0
<c.magenta>而且为此我们为你提供了</c>


674
00:37:32,753 --> 00:37:36,156 line:0
<c.magenta>一个简单的方法 在PHPhotoLibrary里</c>


675
00:37:36,223 --> 00:37:37,958 line:0
<c.magenta>可以双向转换</c>


676
00:37:38,025 --> 00:37:42,663 line:0
<c.magenta>从全局 从pod标识符</c>
<c.magenta>到本地 反之亦然</c>


677
00:37:45,566 --> 00:37:47,634 line:-1
<c.magenta>接下来 我想讲讲布局</c>


678
00:37:49,136 --> 00:37:53,807 line:-2
<c.magenta>我们不仅想提供资产</c>
<c.magenta>以及围绕管护的一些构造</c>


679
00:37:53,874 --> 00:37:56,076 line:-1
<c.magenta>我们想给你一些提示</c>


680
00:37:57,077 --> 00:38:00,380 line:-1
<c.magenta>关于如何表现那些资产给用户 好吧</c>


681
00:38:00,447 --> 00:38:03,217 line:-1
<c.magenta>帮助你解决那些复杂的问题</c>


682
00:38:03,283 --> 00:38:04,818 line:-1
<c.magenta>比如网格布局</c>


683
00:38:05,118 --> 00:38:10,524 line:-2
<c.magenta>好 你在看一个回忆</c>
<c.magenta>我们已经做了很多辛苦的工作</c>


684
00:38:10,991 --> 00:38:14,161 line:-2
<c.magenta>来布局这个被管护的网格</c>
<c.magenta>用一种非常有趣的方式</c>


685
00:38:14,228 --> 00:38:15,662 line:-1
<c.magenta>对用户来说很愉快</c>


686
00:38:16,663 --> 00:38:19,233 line:-2
<c.magenta>如果你可以访问那个布局</c>
<c.magenta>不是很好吗</c>


687
00:38:19,867 --> 00:38:21,068 line:-1
<c.magenta>你确实可以访问</c>


688
00:38:21,869 --> 00:38:23,637 line:-1
<c.magenta>但是为了访问</c>


689
00:38:24,505 --> 00:38:27,374 line:-1
<c.magenta>我们首先确立了一些规则</c>


690
00:38:27,441 --> 00:38:29,142 line:-1
<c.magenta>一个坐标系</c>


691
00:38:30,644 --> 00:38:32,012 line:-1
<c.magenta>所以 如果你查看回忆</c>


692
00:38:32,079 --> 00:38:34,948 line:-1
<c.magenta>会发现一切都排列到一个特定的网格</c>


693
00:38:35,015 --> 00:38:37,851 line:-1
<c.magenta>这是由4乘3单元格构成的网格</c>


694
00:38:39,119 --> 00:38:43,323 line:-1
<c.magenta>但它是一个奇怪的 非正方形尺寸</c>


695
00:38:43,390 --> 00:38:44,958 line:-1
<c.magenta>来回分享</c>


696
00:38:45,025 --> 00:38:46,827 line:-1
<c.magenta>对你来说是一个奇怪的尺寸</c>


697
00:38:47,427 --> 00:38:49,429 line:-1
<c.magenta>我们只需再除一下</c>


698
00:38:50,564 --> 00:38:51,965 line:0
<c.magenta>本例中该布局</c>


699
00:38:52,032 --> 00:38:56,069 line:0
<c.magenta>是由20个统一列组成</c>


700
00:38:57,004 --> 00:38:58,839 line:0
<c.magenta>我们称之为网格空间</c>


701
00:38:59,673 --> 00:39:02,009 line:0
<c.magenta>一旦我们确立了这个坐标系</c>


702
00:39:02,075 --> 00:39:03,644 line:0
<c.magenta>可以根据需求任意缩放</c>


703
00:39:03,710 --> 00:39:06,547 line:0
<c.magenta>它只是一个乘法器</c>
<c.magenta>无论输出结果</c>


704
00:39:06,880 --> 00:39:09,283 line:0
<c.magenta>对吧 如果你正在调整一个窗口大小</c>


705
00:39:09,349 --> 00:39:13,020 line:0
<c.magenta>或在不同大小的网络浏览器的工作</c>


706
00:39:13,086 --> 00:39:16,190 line:0
<c.magenta>你可以用这个数据了解</c>
<c.magenta>该内容如何布局</c>


707
00:39:17,324 --> 00:39:20,727 line:0
<c.magenta>也会让我们可以和你交流位置信息</c>


708
00:39:21,128 --> 00:39:22,996 line:0
<c.magenta>在这个例子里 我有这张照片</c>


709
00:39:23,063 --> 00:39:25,399 line:0
<c.magenta>想在左上角动起来</c>


710
00:39:25,632 --> 00:39:29,169 line:0
<c.magenta>我可以很简单地告诉你 它在00位置</c>


711
00:39:29,236 --> 00:39:32,506 line:0
<c.magenta>它有8格空间宽 9格空间高</c>


712
00:39:36,043 --> 00:39:38,011 line:-1
<c.magenta>接下来我想讲讲元素</c>


713
00:39:40,447 --> 00:39:43,317 line:-2
<c.magenta>在sectionContent里</c>
<c.magenta>我们提供了一组元素</c>


714
00:39:43,383 --> 00:39:48,488 line:-2
<c.magenta>所有的元素都是</c>
<c.magenta>PHProjectElement的子集</c>


715
00:39:49,122 --> 00:39:50,757 line:-1
<c.magenta>这里有两个非常重要的属性</c>


716
00:39:50,824 --> 00:39:53,293 line:-1
<c.magenta>一个是位置 我们刚讲过</c>


717
00:39:54,027 --> 00:39:56,864 line:-1
<c.magenta>另一个被称为权重</c>


718
00:39:58,665 --> 00:40:00,868 line:-1
<c.magenta>再次回到回忆的功能</c>


719
00:40:03,237 --> 00:40:04,171 line:-1
<c.magenta>我们讲过</c>


720
00:40:04,238 --> 00:40:06,406 line:-1
<c.magenta>所有我们正在研究的智能 对吧</c>


721
00:40:06,607 --> 00:40:12,746 line:-1
<c.magenta>在大量资产中确定最相关的照片</c>


722
00:40:14,114 --> 00:40:15,749 line:-1
<c.magenta>也就是我们的评分系统</c>


723
00:40:16,450 --> 00:40:18,085 line:-1
<c.magenta>我们想和你分享这部分内容</c>


724
00:40:18,585 --> 00:40:24,157 line:-1
<c.magenta>所以 我们通过给元素一个权重 好吧</c>


725
00:40:24,224 --> 00:40:26,960 line:-1
<c.magenta>这是一个规范化的权重值从0到1.0</c>


726
00:40:28,095 --> 00:40:33,267 line:-2
<c.magenta>默认值是0.5</c>
<c.magenta>也就是说并不是最重要的</c>


727
00:40:33,333 --> 00:40:36,570 line:-2
<c.magenta>但也不是很不重要</c>
<c.magenta>希望听上去有道理</c>


728
00:40:37,538 --> 00:40:41,308 line:-2
<c.magenta>但是你知道 它是一个规范化分数</c>
<c.magenta>遍布整个区域</c>


729
00:40:41,375 --> 00:40:44,178 line:-1
<c.magenta>你可以利用它做出很多惊人的事 好吗</c>


730
00:40:44,244 --> 00:40:45,679 line:-1
<c.magenta>而且非常容易 好吗</c>


731
00:40:45,746 --> 00:40:47,447 line:-1
<c.magenta>用这种方式对资产进行排序</c>


732
00:40:47,648 --> 00:40:52,019 line:-2
<c.magenta>决定在哪里切断</c>
<c.magenta>你知道 一个大量资产的数组</c>


733
00:40:52,085 --> 00:40:54,087 line:-1
<c.magenta>只处理重要的资产</c>


734
00:40:54,321 --> 00:40:56,490 line:-1
<c.magenta>好吗？把它们作为选项表现给用户</c>


735
00:40:56,557 --> 00:41:02,429 line:-1
<c.magenta>你首先处理高权重的资产</c>


736
00:41:02,729 --> 00:41:06,366 line:-2
<c.magenta>并预测该资产应该是</c>
<c.magenta>用户正在寻找的 想要的</c>


737
00:41:10,337 --> 00:41:11,672 line:-1
<c.magenta>还有一点</c>


738
00:41:12,573 --> 00:41:16,076 line:-1
<c.magenta>这一点是某个元素特有的</c>


739
00:41:16,143 --> 00:41:18,312 line:-1
<c.magenta>也就是PHProjectAssetElement</c>


740
00:41:18,879 --> 00:41:21,248 line:-1
<c.magenta>我们有这样一个概念 称为兴趣区</c>


741
00:41:24,718 --> 00:41:26,653 line:-1
<c.magenta>你知道 如你所知</c>


742
00:41:26,820 --> 00:41:30,324 line:-1
<c.magenta>在macOS API里 已经有很多方法</c>


743
00:41:30,557 --> 00:41:34,428 line:-1
<c.magenta>来进行面部识别 寻找图片里的脸</c>


744
00:41:36,430 --> 00:41:39,433 line:-1
<c.magenta>但从这些方法无法知道这些脸的相关性</c>


745
00:41:39,633 --> 00:41:41,802 line:-1
<c.magenta>你不知道这些脸是否代表着</c>


746
00:41:41,869 --> 00:41:44,238 line:-1
<c.magenta>某个人生命中特别有意义的人</c>


747
00:41:45,005 --> 00:41:46,740 line:-1
<c.magenta>或只是人群中的陌生人</c>


748
00:41:46,807 --> 00:41:50,143 line:-1
<c.magenta>那个在公园里走在你身后的人</c>


749
00:41:50,410 --> 00:41:53,380 line:-1
<c.magenta>当你想给家人拍照时 对吗</c>


750
00:41:53,447 --> 00:41:56,116 line:-1
<c.magenta>你真的无法辨别出来</c>


751
00:41:57,317 --> 00:42:01,488 line:-1
<c.magenta>我们想给你什么让你知道</c>


752
00:42:01,555 --> 00:42:04,391 line:-1
<c.magenta>并让你信任我们标出来的</c>


753
00:42:04,458 --> 00:42:07,761 line:-2
<c.magenta>如果我们说这很有趣</c>
<c.magenta>那它就应该有趣 对吗</c>


754
00:42:07,828 --> 00:42:12,032 line:-2
<c.magenta>如果可以对此加以利用</c>
<c.magenta>将可以为用户创造魔法</c>


755
00:42:12,432 --> 00:42:14,568 line:-1
<c.magenta>并不是一定要知道为什么</c>


756
00:42:15,602 --> 00:42:17,171 line:-1
<c.magenta>我们更进一步</c>


757
00:42:17,237 --> 00:42:19,673 line:-1
<c.magenta>如果你注意到 这些上面有标识符</c>


758
00:42:20,374 --> 00:42:23,977 line:-2
<c.magenta>我们实际上在不同的图片上</c>
<c.magenta>会改变这些标识符</c>


759
00:42:24,511 --> 00:42:27,648 line:-2
<c.magenta>所以如果我们知道这个东西</c>
<c.magenta>在这张照片里很有趣</c>


760
00:42:28,148 --> 00:42:31,185 line:-1
<c.magenta>并且代表了相同的东西</c>


761
00:42:31,251 --> 00:42:35,088 line:-2
<c.magenta>或在另一张照片里相同的人</c>
<c.magenta>我们会给他们相同的标识符</c>


762
00:42:35,422 --> 00:42:38,458 line:-1
<c.magenta>如果你正在处理动画 幻灯片等</c>


763
00:42:38,525 --> 00:42:40,761 line:-1
<c.magenta>这将非常有用</c>


764
00:42:41,128 --> 00:42:46,099 line:-2
<c.magenta>因为你现在可以真正把</c>
<c.magenta>大集合中的图片位置彼此联系起来</c>


765
00:42:49,203 --> 00:42:51,505 line:-1
<c.magenta>所以 我本来可以继续看代码</c>


766
00:42:53,006 --> 00:42:56,143 line:-1
<c.magenta>但我还是给你们放一段演示</c>


767
00:42:57,010 --> 00:43:00,247 line:-1
<c.magenta>因为我觉得这非常重要</c>


768
00:43:00,480 --> 00:43:03,217 line:-1
<c.magenta>让你们看看创建一个扩展有多么容易</c>


769
00:43:03,951 --> 00:43:05,219 line:-1
<c.magenta>我在Xcode里</c>


770
00:43:05,986 --> 00:43:08,355 line:-1
<c.magenta>我承诺如果需要会放大屏幕</c>


771
00:43:08,422 --> 00:43:09,623 line:-1
<c.magenta>以便你们可以看清楚</c>


772
00:43:10,757 --> 00:43:11,925 line:-1
<c.magenta>所以 我在Xcode里</c>


773
00:43:12,492 --> 00:43:15,295 line:-2
<c.magenta>我启动了一个项目</c>
<c.magenta>但实际上里面什么都没有</c>


774
00:43:15,362 --> 00:43:18,198 line:-1
<c.magenta>只有一些设计师给我的资产</c>


775
00:43:18,932 --> 00:43:23,170 line:-1
<c.magenta>我们现在要做的 是一个幻灯片</c>


776
00:43:23,937 --> 00:43:25,172 line:-1
<c.magenta>这个幻灯片将是</c>


777
00:43:25,239 --> 00:43:28,542 line:-1
<c.magenta>包含照片应用提供的内容</c>


778
00:43:28,809 --> 00:43:32,479 line:-2
<c.magenta>并将其同步成</c>
<c.magenta>非常引人入胜的3D动画</c>


779
00:43:34,681 --> 00:43:35,516 line:-1
<c.magenta>让我们开始</c>


780
00:43:36,817 --> 00:43:39,386 line:-2
<c.magenta>首先我可以做的是</c>
<c.magenta>我点击“项目”</c>


781
00:43:39,887 --> 00:43:43,090 line:-2
<c.magenta>在底部有一个小的加号按钮</c>
<c.magenta>“添加目标”</c>


782
00:43:44,057 --> 00:43:45,392 line:-1
<c.magenta>我在这里添加一个目标</c>


783
00:43:45,459 --> 00:43:49,329 line:-1
<c.magenta>你会发现 出现了一个全新的模板</c>


784
00:43:50,397 --> 00:43:52,232 line:-1
<c.magenta>是PhotoProject扩展</c>


785
00:43:52,432 --> 00:43:54,768 line:-1
<c.magenta>所以选中该模板 给它命名</c>


786
00:43:56,703 --> 00:43:57,538 line:-1
<c.magenta>Picture Show</c>


787
00:43:59,673 --> 00:44:00,674 line:-1
<c.magenta>点击完成按钮</c>


788
00:44:01,375 --> 00:44:03,777 line:-1
<c.magenta>是的 我想激活它成为一个方案</c>


789
00:44:03,844 --> 00:44:05,579 line:-1
<c.magenta>之后运行它将会变得非常容易</c>


790
00:44:06,647 --> 00:44:09,650 line:-1
<c.magenta>然后 我提过设计师给我了这些资产</c>


791
00:44:09,716 --> 00:44:12,019 line:-1
<c.magenta>已经存在于项目中</c>


792
00:44:12,085 --> 00:44:15,756 line:-1
<c.magenta>我只想让它们在扩展中也能被引用</c>


793
00:44:16,557 --> 00:44:19,159 line:-1
<c.magenta>通过复制阶段添加这些</c>


794
00:44:20,994 --> 00:44:24,064 line:-1
<c.magenta>这是整个资产集合</c>


795
00:44:24,398 --> 00:44:27,367 line:-2
<c.magenta>点击“添加”按钮</c>
<c.magenta>这已经让我们写了一些代码</c>


796
00:44:29,536 --> 00:44:32,472 line:-1
<c.magenta>现在 如果仔细看</c>


797
00:44:32,539 --> 00:44:36,577 line:-1
<c.magenta>会发现Xcode已经为我添加了这个组</c>


798
00:44:36,643 --> 00:44:38,245 line:-1
<c.magenta>为我的目标 为我的Picture Show</c>


799
00:44:38,779 --> 00:44:42,950 line:-1
<c.magenta>在里面 已经准备好一个视图控制器</c>


800
00:44:43,016 --> 00:44:45,385 line:-1
<c.magenta>它符合我们实行的协议</c>


801
00:44:47,988 --> 00:44:49,456 line:-1
<c.magenta>继续进去</c>


802
00:44:50,791 --> 00:44:53,760 line:-1
<c.magenta>首先添加一些属性</c>


803
00:44:56,663 --> 00:44:58,932 line:0
<c.magenta>在这里添加一小部分属性集合</c>


804
00:44:58,999 --> 00:45:02,002 line:0
<c.magenta>保持给我的上下文</c>


805
00:45:02,436 --> 00:45:03,437 line:0
<c.magenta>我有一些数组</c>


806
00:45:03,504 --> 00:45:07,241 line:0
<c.magenta>区分幻灯片的横向或纵向资产</c>


807
00:45:07,608 --> 00:45:09,510 line:0
<c.magenta>我有一个场景视图插座</c>


808
00:45:10,210 --> 00:45:11,378 line:0
<c.magenta>有一个动画生成器</c>


809
00:45:12,546 --> 00:45:15,282 line:0
<c.magenta>以及两个预期编译器</c>


810
00:45:15,349 --> 00:45:16,917 line:0
<c.magenta>还没有导入sceneKit</c>


811
00:45:17,751 --> 00:45:19,386 line:0
<c.magenta>很容易可以修正</c>


812
00:45:22,189 --> 00:45:24,157 line:0
<c.magenta>动画生成器是我自己的类</c>


813
00:45:24,224 --> 00:45:25,459 line:0
<c.magenta>只是还没有创建出来</c>


814
00:45:25,526 --> 00:45:28,161 line:0
<c.magenta>所以让我们现在就去创建</c>


815
00:45:31,431 --> 00:45:34,568 line:-1
<c.magenta>点击“新建” 选择swift文件</c>


816
00:45:36,870 --> 00:45:38,572 line:-1
<c.magenta>我们将其命名为Animator</c>


817
00:45:42,910 --> 00:45:44,044 line:-1
<c.magenta>然后</c>


818
00:45:48,415 --> 00:45:49,416 line:-1
<c.magenta>动画生成器创建好了</c>


819
00:45:51,118 --> 00:45:52,452 line:-1
<c.magenta>我不会带着大家浏览全部代码</c>


820
00:45:52,519 --> 00:45:53,987 line:-1
<c.magenta>但其实非常非常简单</c>


821
00:45:54,188 --> 00:45:56,290 line:-1
<c.magenta>所以 我只想讲讲它实现的部分功能</c>


822
00:45:56,957 --> 00:46:00,761 line:-1
<c.magenta>当初始化动画时 我只想进入场景中</c>


823
00:46:01,094 --> 00:46:03,397 line:-1
<c.magenta>取出一些场景的特定元素</c>


824
00:46:03,463 --> 00:46:06,967 line:-2
<c.magenta>我想在该3D场景里</c>
<c.magenta>找到这些标记的相框</c>


825
00:46:07,367 --> 00:46:10,571 line:-1
<c.magenta>并且深入其中 在玻璃后面</c>


826
00:46:10,637 --> 00:46:13,774 line:-2
<c.magenta>找出那些材料</c>
<c.magenta>变成我想要展现的照片</c>


827
00:46:13,841 --> 00:46:16,210 line:-1
<c.magenta>在这些框架的玻璃后面</c>


828
00:46:16,577 --> 00:46:18,879 line:-1
<c.magenta>这就是初始化真正所做的全部</c>


829
00:46:19,279 --> 00:46:22,983 line:-1
<c.magenta>从这一点开始 场景</c>


830
00:46:23,050 --> 00:46:24,618 line:-1
<c.magenta>我知道这有一点令人头晕</c>


831
00:46:24,685 --> 00:46:27,087 line:-1
<c.magenta>有点像转桌子</c>


832
00:46:28,055 --> 00:46:31,491 line:-2
<c.magenta>我有个小策略</c>
<c.magenta>好比你是一个好魔术师</c>


833
00:46:31,558 --> 00:46:33,861 line:-1
<c.magenta>当你不再看切换照片时</c>


834
00:46:34,161 --> 00:46:36,296 line:-1
<c.magenta>所以 我用几个计时器来实现</c>


835
00:46:37,531 --> 00:46:38,899 line:-1
<c.magenta>基本上这就是动画</c>


836
00:46:39,733 --> 00:46:44,671 line:-1
<c.magenta>回到控制器 开始填充有趣的位</c>


837
00:46:45,939 --> 00:46:48,642 line:-1
<c.magenta>当用户创建其中一个项目时</c>


838
00:46:50,043 --> 00:46:52,479 line:-1
<c.magenta>我想保存数据</c>


839
00:46:52,546 --> 00:46:54,515 line:-1
<c.magenta>因为我想让用户可以返回到这张幻灯片</c>


840
00:46:54,581 --> 00:46:55,649 line:-1
<c.magenta>在任何时间点</c>


841
00:46:56,250 --> 00:46:57,851 line:-1
<c.magenta>我来添加一些数据方法</c>


842
00:46:57,918 --> 00:47:01,555 line:-1
<c.magenta>这里是一个SaveProjectData函数</c>


843
00:47:02,222 --> 00:47:05,092 line:-1
<c.magenta>实现的就是在幻灯片看到的功能 对吧</c>


844
00:47:05,158 --> 00:47:07,928 line:-1
<c.magenta>这和我们刚刚讲的非常类似</c>


845
00:47:08,996 --> 00:47:11,899 line:-1
<c.magenta>然后加载数据 只是读回去</c>


846
00:47:13,000 --> 00:47:16,336 line:-2
<c.magenta>我正在获取云资产标识符</c>
<c.magenta>通过取消存档我的数据</c>


847
00:47:16,904 --> 00:47:19,206 line:-1
<c.magenta>然后将它们转换为本地标识符</c>


848
00:47:19,540 --> 00:47:20,874 line:-1
<c.magenta>从那开始</c>


849
00:47:21,508 --> 00:47:26,146 line:0
<c.magenta>我可以完成</c>
<c.magenta>PHAsset.fetchAssets请求</c>


850
00:47:26,213 --> 00:47:27,581 line:0
<c.magenta>用这些本地标识符</c>


851
00:47:29,950 --> 00:47:33,520 line:-1
<c.magenta>好 回到顶部 开始填充剩下的</c>


852
00:47:33,720 --> 00:47:34,788 line:-1
<c.magenta>所以 viewDidLoad</c>


853
00:47:40,093 --> 00:47:42,629 line:-1
<c.magenta>我只需实例化动画生成器 之前提过</c>


854
00:47:43,897 --> 00:47:45,098 line:-1
<c.magenta>supportedProjectTypes</c>


855
00:47:45,165 --> 00:47:48,101 line:-1
<c.magenta>本例不需要询问用户任何事情</c>


856
00:47:48,202 --> 00:47:51,238 line:-1
<c.magenta>所以不用填充 只是一张幻灯片</c>


857
00:47:52,706 --> 00:47:55,709 line:-1
<c.magenta>但是beginProject显然需要做些什么</c>


858
00:47:56,910 --> 00:47:58,312 line:-1
<c.magenta>我们填充进去</c>


859
00:47:59,279 --> 00:48:05,118 line:-2
<c.magenta>本例中我所做的是</c>
<c.magenta>获取真正的分区数组</c>


860
00:48:06,019 --> 00:48:09,389 line:-1
<c.magenta>我在搜索第一个分区类型内容</c>


861
00:48:10,023 --> 00:48:11,959 line:-1
<c.magenta>都是根据一个回忆进行设计</c>


862
00:48:12,025 --> 00:48:13,327 line:-1
<c.magenta>如之前所讲到的</c>


863
00:48:13,961 --> 00:48:16,663 line:-1
<c.magenta>从那里 我想要得到最受管护的资产</c>


864
00:48:16,730 --> 00:48:18,832 line:-1
<c.magenta>我想要最高级别的摘要</c>


865
00:48:19,132 --> 00:48:21,668 line:-1
<c.magenta>所以 我请求数组的第一个对象</c>


866
00:48:22,736 --> 00:48:27,307 line:-2
<c.magenta>从中获取云资产标识符</c>
<c.magenta>成功实现了</c>


867
00:48:28,542 --> 00:48:32,513 line:-1
<c.magenta>现在后台 我想保存项目数据</c>


868
00:48:32,579 --> 00:48:35,482 line:-2
<c.magenta>这样当用户回到幻灯片时</c>
<c.magenta>数据依然存在</c>


869
00:48:37,117 --> 00:48:41,188 line:-1
<c.magenta>进入resumeProject 非常简单</c>


870
00:48:43,891 --> 00:48:46,960 line:-1
<c.magenta>只需保持上下文</c>


871
00:48:47,294 --> 00:48:49,930 line:-1
<c.magenta>加载项目数据 实例化动画生成器</c>


872
00:48:51,632 --> 00:48:53,534 line:-1
<c.magenta>最后在finishProject里</c>


873
00:48:58,205 --> 00:48:59,673 line:-1
<c.magenta>暂停动画</c>


874
00:48:59,740 --> 00:49:01,108 line:-1
<c.magenta>不需要启动这些计时器</c>


875
00:49:01,175 --> 00:49:03,911 line:-2
<c.magenta>当用户在做别的事时</c>
<c.magenta>我不想风扇一直转</c>


876
00:49:04,144 --> 00:49:05,045 line:-1
<c.magenta>只需将它暂停</c>


877
00:49:06,680 --> 00:49:07,514 line:-1
<c.magenta>相信不相信</c>


878
00:49:07,581 --> 00:49:09,816 line:-1
<c.magenta>这就是该扩展的全部代码</c>


879
00:49:09,883 --> 00:49:11,018 line:-1
<c.magenta>就是我的幻灯片</c>


880
00:49:11,351 --> 00:49:13,520 line:-1
<c.magenta>我还没做的事 即连接UI</c>


881
00:49:14,354 --> 00:49:15,322 line:-1
<c.magenta>可以很快实现</c>


882
00:49:15,389 --> 00:49:18,559 line:-1
<c.magenta>模板为视图控制器提供了视图</c>


883
00:49:18,825 --> 00:49:20,427 line:-1
<c.magenta>删除默认字符串</c>


884
00:49:21,228 --> 00:49:23,297 line:-1
<c.magenta>在上面添加一个场景</c>


885
00:49:28,468 --> 00:49:30,237 line:-1
<c.magenta>添加一个sceneKit视图</c>


886
00:49:30,971 --> 00:49:34,408 line:-1
<c.magenta>我来调整一下大小</c>


887
00:49:35,442 --> 00:49:39,880 line:-2
<c.magenta>进入这里 设为自动调整大小</c>
<c.magenta>设为全景视图</c>


888
00:49:42,115 --> 00:49:45,018 line:-1
<c.magenta>还需要做的唯一一件事</c>


889
00:49:45,085 --> 00:49:47,221 line:-1
<c.magenta>就是选择场景本身</c>


890
00:49:47,287 --> 00:49:49,556 line:-1
<c.magenta>已经存在于加载进来的资产里</c>


891
00:49:50,224 --> 00:49:52,459 line:-1
<c.magenta>只需将它和视图控制器连起来</c>


892
00:49:53,126 --> 00:49:55,295 line:-1
<c.magenta>所以 按Control键拖到文件所有人</c>


893
00:49:55,896 --> 00:49:58,799 line:-1
<c.magenta>可以看到在属性里添加的插座</c>


894
00:50:00,033 --> 00:50:02,736 line:-1
<c.magenta>就这样 可以运行了</c>


895
00:50:04,671 --> 00:50:05,672 line:-1
<c.magenta>点击“播放”</c>


896
00:50:05,739 --> 00:50:09,109 line:-2
<c.magenta>将会询问选择应用</c>
<c.magenta>显然 本例选择“照片”</c>


897
00:50:14,715 --> 00:50:17,184 line:-1
<c.magenta>生成 成功</c>


898
00:50:17,684 --> 00:50:21,522 line:-2
<c.magenta>“照片”启动</c>
<c.magenta>选择一个回忆</c>


899
00:50:21,688 --> 00:50:23,924 line:-1
<c.magenta>本例我想选择</c>


900
00:50:24,258 --> 00:50:28,295 line:-1
<c.magenta>我想选择这个去非常酷的香港之旅</c>


901
00:50:28,962 --> 00:50:30,464 line:-1
<c.magenta>点击加号按钮 看</c>


902
00:50:30,531 --> 00:50:32,699 line:-1
<c.magenta>在照片里出现了这个扩展</c>


903
00:50:34,468 --> 00:50:35,335 line:-1
<c.magenta>选中</c>


904
00:50:35,802 --> 00:50:36,703 line:-1
<c.magenta>当我选中时</c>


905
00:50:36,770 --> 00:50:39,039 line:-1
<c.magenta>是第一次运行这个扩展</c>


906
00:50:39,373 --> 00:50:43,877 line:-2
<c.magenta>作为扩展没有访问整个</c>
<c.magenta>Photo Library权限</c>


907
00:50:43,944 --> 00:50:45,746 line:-1
<c.magenta>还记得我们的API</c>


908
00:50:45,812 --> 00:50:48,182 line:-1
<c.magenta>把整个Photo Library传给了扩展</c>


909
00:50:48,582 --> 00:50:51,718 line:-1
<c.magenta>因此用户不必授予该访问权限</c>


910
00:50:52,152 --> 00:50:53,120 line:-1
<c.magenta>只需点击“确定”</c>


911
00:50:53,687 --> 00:50:54,855 line:-1
<c.magenta>幻灯片加载成功</c>


912
00:51:04,064 --> 00:51:07,835 line:-1
<c.magenta>我还将演示另一个细节</c>


913
00:51:07,935 --> 00:51:09,469 line:-1
<c.magenta>请看侧栏</c>


914
00:51:09,736 --> 00:51:12,072 line:-1
<c.magenta>有一个刚创建的项目 “香港岛”</c>


915
00:51:13,340 --> 00:51:16,910 line:-1
<c.magenta>它被保存在库里 紧挨着别的项目</c>


916
00:51:17,444 --> 00:51:18,412 line:-1
<c.magenta>选择该项目</c>


917
00:51:19,246 --> 00:51:23,717 line:-2
<c.magenta>可以看到它由一个叫作</c>
<c.magenta>“Picture Show”的扩展所创建</c>


918
00:51:24,251 --> 00:51:25,352 line:-1
<c.magenta>打开</c>


919
00:51:26,687 --> 00:51:28,689 line:-1
<c.magenta>将会马上回到同样的幻灯片</c>


920
00:51:30,390 --> 00:51:33,927 line:-1
<c.magenta>这就是照片项目扩展</c>


921
00:51:36,763 --> 00:51:37,598 line:-1
<c.magenta>谢谢</c>


922
00:51:42,202 --> 00:51:46,440 line:-1
<c.magenta>在刚过去55分钟里我们讲了很多</c>


923
00:51:48,609 --> 00:51:51,245 line:-1
<c.magenta>讲了iOS里的无摩擦照片选择器</c>


924
00:51:51,378 --> 00:51:55,749 line:-2
<c.magenta>非常非常好的进步</c>
<c.magenta>允许你在原始的URL获得照片</c>


925
00:51:55,816 --> 00:51:57,251 line:-1
<c.magenta>拥有高质量视频</c>


926
00:51:57,484 --> 00:51:59,453 line:-1
<c.magenta>为你们准备了很好的东西</c>


927
00:51:59,786 --> 00:52:03,123 line:-2
<c.magenta>Andreas为大家讲解了</c>
<c.magenta>全新的媒体表达类型</c>


928
00:52:03,490 --> 00:52:06,426 line:-2
<c.magenta>我迫不及待地想看你们</c>
<c.magenta>如何吸收这些</c>


929
00:52:06,493 --> 00:52:08,629 line:-1
<c.magenta>以及在自己的应用里如何处理</c>


930
00:52:09,796 --> 00:52:11,932 line:-1
<c.magenta>允许用户看到内容播放</c>


931
00:52:11,999 --> 00:52:13,233 line:-1
<c.magenta>以自己想要的方式</c>


932
00:52:13,700 --> 00:52:16,970 line:-1
<c.magenta>他还讲到用大型图片库进行测试</c>


933
00:52:17,337 --> 00:52:18,238 line:-1
<c.magenta>提醒一下</c>


934
00:52:18,305 --> 00:52:21,775 line:-1
<c.magenta>有一个示例应用可以用来填充库</c>


935
00:52:21,842 --> 00:52:26,213 line:-2
<c.magenta>里面有成千上万的资产</c>
<c.magenta>可以用这种方式测试</c>


936
00:52:26,813 --> 00:52:29,183 line:-1
<c.magenta>然后 最后我们讲了项目扩展</c>


937
00:52:29,249 --> 00:52:33,587 line:-1
<c.magenta>我非常非常期待你们有所创新</c>


938
00:52:33,687 --> 00:52:38,292 line:-2
<c.magenta>在App Store里</c>
<c.magenta>当今年秋天macOS High Sierra推出时</c>


939
00:52:39,459 --> 00:52:41,495 line:-1
<c.magenta>更多信息 请访问该链接</c>


940
00:52:41,562 --> 00:52:44,231 line:-1
<c.magenta>developer.apple.com网站</c>


941
00:52:45,098 --> 00:52:47,434 line:-1
<c.magenta>再讲一下相关演讲</c>


942
00:52:47,668 --> 00:52:53,006 line:0
<c.magenta>本场演讲结束后 就在这个会场</c>
<c.magenta>将会有一个非常非常精彩的演讲</c>


943
00:52:53,073 --> 00:52:55,375 line:0
<c.magenta>为大家介绍影像框架</c>


944
00:52:55,542 --> 00:52:57,344 line:0
<c.magenta>我知道你们都会等着听的</c>


945
00:52:57,711 --> 00:53:01,281 line:0
<c.magenta>今晚 在行政宴会厅</c>


946
00:53:01,415 --> 00:53:06,653 line:0
<c.magenta>将会有两场演讲的第一场</c>
<c.magenta>关于iPhone深度摄影技巧</c>


947
00:53:06,920 --> 00:53:08,555 line:0
<c.magenta>并有非常精彩的演示</c>


948
00:53:08,622 --> 00:53:11,558 line:0
<c.magenta>你们一定也非常非常想参与</c>


949
00:53:11,792 --> 00:53:13,627 line:0
<c.magenta>最后 今晚我们要做一件事</c>


950
00:53:13,694 --> 00:53:15,963 line:0
<c.magenta>从未在WWDC上做过</c>


951
00:53:16,296 --> 00:53:18,298 line:0
<c.magenta>我们将会举行一个“一起来摄影”活动</c>


952
00:53:18,398 --> 00:53:19,566 line:0
<c.magenta>地点是楼下</c>


953
00:53:19,633 --> 00:53:22,636 line:0
<c.magenta>科学实验室区 具体是实验室J</c>


954
00:53:23,237 --> 00:53:24,872 line:0
<c.magenta>我会在那儿</c>


955
00:53:25,138 --> 00:53:27,374 line:0
<c.magenta>本次演讲的另两位演讲者也会去</c>


956
00:53:27,441 --> 00:53:30,677 line:0
<c.magenta>所有今天关于Cameron Photos</c>
<c.magenta>的演讲者都会到场</c>


957
00:53:30,744 --> 00:53:34,047 line:0
<c.magenta>还会有很多工程师 管理人员</c>


958
00:53:34,314 --> 00:53:36,283 line:0
<c.magenta>希望你们大家也都到场</c>


959
00:53:36,583 --> 00:53:38,619 line:0
<c.magenta>享受接下来的演讲 非常感谢</c>

